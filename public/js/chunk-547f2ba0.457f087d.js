(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-547f2ba0"],{"0fe6":function(e,t,n){"use strict";n("861c")},2824:function(e,t,n){"use strict";var r=n("7a23"),o={key:0,class:"pagination"};function a(e,t,n,a,c,i){var s=Object(r["resolveComponent"])("el-form"),l=Object(r["resolveComponent"])("el-pagination"),u=Object(r["resolveComponent"])("el-main"),d=Object(r["resolveComponent"])("el-skeleton");return Object(r["openBlock"])(),Object(r["createBlock"])(d,{rows:5,animated:"",loading:n.loading},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{inline:!0,class:"form"},{default:Object(r["withCtx"])((function(){return[Object(r["renderSlot"])(e.$slots,"header")]})),_:3}),Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["renderSlot"])(e.$slots,"body"),c.T_pagination.show_page?(Object(r["openBlock"])(),Object(r["createBlock"])("div",o,[Object(r["createVNode"])(l,{onCurrentChange:i.__currentChange,"page-size":c.T_pagination.limit,layout:"total, prev, pager, next",total:c.T_pagination.total,"current-page":c.T_pagination.page},null,8,["onCurrentChange","page-size","total","current-page"])])):Object(r["createCommentVNode"])("",!0)]})),_:3}),Object(r["renderSlot"])(e.$slots,"dialog")]})),_:3},8,["loading"])}var c={name:"BaseLayout",props:{loading:{type:Boolean,default:function(){return!1}},pagination:{type:Object,default:function(){}}},watch:{pagination:function(){this.T_pagination=this.pagination}},data:function(){return{T_pagination:this.pagination||{limit:10,page:1,total:0,show_page:!1}}},methods:{__currentChange:function(e){this.$parent.currentPageChange(e)}}};n("0fe6");c.render=a;t["a"]=c},"58ea":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={props:["syncVisible"],data:function(){return{visible:this.syncVisible}},watch:{syncVisible:function(){this.visible=this.syncVisible}}}},"5ed0":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),o=Object(r["withScopeId"])("data-v-1dbad114");Object(r["pushScopeId"])("data-v-1dbad114");var a=Object(r["createTextVNode"])("新增");Object(r["popScopeId"])();var c=o((function(e,t,n,c,i,s){var l=Object(r["resolveComponent"])("el-button"),u=Object(r["resolveComponent"])("el-form-item"),d=Object(r["resolveComponent"])("PushLists"),p=Object(r["resolveComponent"])("PushDialog"),m=Object(r["resolveComponent"])("BaseLayout");return Object(r["openBlock"])(),Object(r["createBlock"])(m,{loading:i.loading,pagination:i.pagination},{header:o((function(){return[Object(r["createVNode"])(u,null,{default:o((function(){return[e.Permission.auth.indexOf(i.savePermission)>-1?(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:0,type:"primary",plain:"",size:"mini",onClick:s.addPush,icon:"el-icon-plus"},{default:o((function(){return[a]})),_:1},8,["onClick"])):Object(r["createCommentVNode"])("",!0)]})),_:1})]})),body:o((function(){return[Object(r["createVNode"])(d,{"push-lists":s.pushLists,onRunPusher:s.runPusher,ref:"pushLists"},null,8,["push-lists","onRunPusher"])]})),dialog:o((function(){return[Object(r["createVNode"])(p,{"sync-visible":i.syncVisible,"re-form":i.reForm,form:i.form,"user-lists":i.userLists,onGetPushLists:s.getPushLists},null,8,["sync-visible","re-form","form","user-lists","onGetPushLists"])]})),_:1},8,["loading","pagination"])})),i=n("1da1"),s=(n("96cf"),n("2824")),l=Object(r["withScopeId"])("data-v-386cd44e");Object(r["pushScopeId"])("data-v-386cd44e");var u=Object(r["createTextVNode"])("执行");Object(r["popScopeId"])();var d=l((function(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("el-table-column"),s=Object(r["resolveComponent"])("el-tag"),d=Object(r["resolveComponent"])("el-button"),p=Object(r["resolveComponent"])("el-table");return Object(r["openBlock"])(),Object(r["createBlock"])(p,{data:n.pushLists},{default:l((function(){return[Object(r["createVNode"])(i,{label:"#ID",prop:"id",width:"100px",align:"center"}),Object(r["createVNode"])(i,{label:"接收者",prop:"username",width:"200px","show-overflow-tooltip":!0}),Object(r["createVNode"])(i,{label:"推送标题",width:"200px",align:"center"},{default:l((function(e){return[Object(r["createVNode"])(s,{effect:"plain",type:"success"},{default:l((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.row.title),1)]})),_:2},1024)]})),_:1}),Object(r["createVNode"])(i,{label:"推送内容",prop:"info","show-overflow-tooltip":!0}),Object(r["createVNode"])(i,{label:"实时推送",width:"100px",align:"center"},{default:l((function(e){return[Object(r["createVNode"])(s,{effect:"plain",type:1===e.row.status?"success":"info"},{default:l((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(1===e.row.status?"是":"否"),1)]})),_:2},1032,["type"])]})),_:1}),Object(r["createVNode"])(i,{label:"推送状态",align:"center",width:"150px"},{default:l((function(e){return[Object(r["createVNode"])(s,{effect:"plain",type:a.typeAttr[e.row.state]},{default:l((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.row.state.toUpperCase()),1)]})),_:2},1032,["type"])]})),_:1}),Object(r["createVNode"])(i,{label:"推送时间",prop:"created_at",align:"center",width:"150px"}),Object(r["createVNode"])(i,{align:"center",width:"150px",label:"操作"},{default:l((function(t){return["successfully"!==t.row.state&&e.Permission.auth.indexOf(a.URL)>-1?(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:0,type:"primary",icon:"el-icon-edit",plain:"",size:"mini",onClick:function(n){return e.$emit("runPusher",t.row)}},{default:l((function(){return[u]})),_:2},1032,["onClick"])):Object(r["createCommentVNode"])("",!0)]})),_:1})]})),_:1},8,["data"])})),p=n("4f8d"),m={name:"PushLists",components:{},props:["pushLists"],data:function(){return{URL:p["a"].push.update,typeAttr:{failed:"danger",successfully:"success",offline:"warning"}}}};m.render=d,m.__scopeId="data-v-386cd44e";var f=m;function b(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("el-option"),s=Object(r["resolveComponent"])("el-select"),l=Object(r["resolveComponent"])("el-form-item"),u=Object(r["resolveComponent"])("el-input"),d=Object(r["resolveComponent"])("el-date-picker"),p=Object(r["resolveComponent"])("el-switch"),m=Object(r["resolveComponent"])("SubmitButton"),f=Object(r["resolveComponent"])("el-form"),b=Object(r["resolveComponent"])("el-dialog");return Object(r["openBlock"])(),Object(r["createBlock"])("div",null,[Object(r["createVNode"])(b,{modelValue:e.visible,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.visible=t}),title:"created"===n.reForm?"添加站内通知":"修改站内通知","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,center:""},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(f,{model:a.localForm,ref:n.reForm,"label-position":"left","label-width":"100px",rules:a.rules},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,{label:"目标用户：",prop:"username"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{modelValue:a.localForm.username,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.localForm.username=e}),onChange:c.handleChange,filterable:"",placeholder:"请选择目标用户"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(i,{label:"站内所有用户",value:e.Permission.default_client_id},null,8,["value"]),(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(n.userLists,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])(i,{key:t,label:e.username,value:e.uuid},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1}),Object(r["createVNode"])(l,{label:"站内标识：",prop:"uuid"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{readonly:"",modelValue:a.localForm.uuid,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.localForm.uuid=e}),placeholder:"请输入站内标识"},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(l,{label:"推送标题：",prop:"title"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{modelValue:a.localForm.title,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.localForm.title=e}),modelModifiers:{trim:!0},placeholder:"请输入推送标题"},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(l,{label:"推送消息：",prop:"info"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{modelValue:a.localForm.info,"onUpdate:modelValue":t[4]||(t[4]=function(e){return a.localForm.info=e}),modelModifiers:{trim:!0},placeholder:"请输入推送消息",type:"textarea",resize:"none",rows:"4"},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(l,{label:"推送时间：",prop:"created_at"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,{type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD HH:mm:ss",modelValue:a.localForm.created_at,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.localForm.created_at=e}),editable:!1},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(l,{label:"实时推送：",class:"is-required"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(p,{modelValue:a.localForm.status,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.localForm.status=e}),modelModifiers:{number:!0},"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":2},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(m,{form:a.submitForm,reForm:n.reForm,onCloseDialog:t[7]||(t[7]=function(t){return e.$emit("getPushLists",{page:1,limit:15,refresh:!0,total:0})})},null,8,["form","reForm"])]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue","title"])])}n("d81d");var h=n("c827"),O=n("6171"),j=n("58ea"),g={name:"PushDialog",components:{SubmitButton:h["a"]},props:["form","reForm","userLists"],mixins:[j["a"]],data:function(){return{localForm:this.form,submitForm:{},rules:{username:[{required:!0,message:"请选择目标用户",trigger:"change"}],uuid:[{required:!0,message:"请输入站内标识",trigger:"blur"}],title:[{required:!0,message:"请输入推送标题",trigger:"blur"}],info:[{required:!0,message:"请输入推送内容",trigger:"blur"}],created_at:[{required:!0,message:"请选择推送时间",trigger:"change",type:"date"}]}}},watch:{form:function(){var e=this;this.localForm=this.form,this.$nextTick((function(){setTimeout((function(){e.submitForm={model:e.localForm,$refs:e.$refs,url:"created"===e.reForm?p["a"].push.save:p["a"].push.update}}),1e3)}))},"localForm.status":function(){this.localForm.created_at=1===this.localForm.status?O["a"].setTime(Date.parse(new Date)):this.form.created_at}},methods:{handleChange:function(e){var t=this;this.localForm.uuid=e,this.userLists.map((function(n){e===n.uuid&&(t.localForm.username=n.username)}))}}};g.render=b;var v=g,V={name:"Push",components:{PushDialog:v,PushLists:f,BaseLayout:s["a"]},data:function(){return{loading:!0,pagination:{page:1,limit:15,total:0,show_page:!0,refresh:!1},syncVisible:!1,reForm:"created",form:{},userLists:[],savePermission:p["a"].push.save}},computed:{pushLists:function(){return this.$store.state.push.pushLists}},mounted:function(){var e=this;this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPushLists(e.pagination);case 2:case"end":return t.stop()}}),t)}))))},methods:{getPushLists:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,t.syncVisible=!1,n.next=4,t.$store.dispatch("push/getPushLists",e).then((function(){t.loading=!1,t.pagination.total=t.$store.state.push.total}));case 4:case"end":return n.stop()}}),n)})))()},currentPageChange:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.pagination.page=e,n.next=3,t.getPushLists(t.pagination);case 3:case"end":return n.stop()}}),n)})))()},addPush:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.form={username:"",uuid:"",title:"",info:"",status:1,state:"failed",created_at:O["a"].setTime(Date.parse(new Date),"en")},e.reForm="created",e.syncVisible=!0,t.next=5,e.$store.dispatch("users/getCacheUserLists",{}).then((function(){e.userLists=e.$store.state.users.cacheUsers}));case 5:case"end":return t.stop()}}),t)})))()},runPusher:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.form=JSON.parse(JSON.stringify(e)),t.reForm="updated",t.syncVisible=!0,n.next=5,t.$store.dispatch("users/getCacheUserLists",{}).then((function(){t.userLists=t.$store.state.users.cacheUsers}));case 5:case"end":return n.stop()}}),n)})))()}}};V.render=c,V.__scopeId="data-v-1dbad114";t["default"]=V},"861c":function(e,t,n){},c827:function(e,t,n){"use strict";var r=n("7a23"),o=Object(r["withScopeId"])("data-v-6b545350"),a=o((function(e,t,n,a,c,i){var s=Object(r["resolveComponent"])("el-button"),l=Object(r["resolveComponent"])("el-main");return Object(r["openBlock"])(),Object(r["createBlock"])(l,{style:{"text-align":"center"}},{default:o((function(){return[Object(r["createVNode"])(s,{type:"primary",size:"medium",plain:"",onClick:i.saveForm},{default:o((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(n.confirmButton||"确定"),1)]})),_:1},8,["onClick"]),Object(r["createVNode"])(s,{type:"default",size:"medium",onClick:t[1]||(t[1]=function(t){return e.$emit("closeDialog")}),plain:""},{default:o((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(n.cancelButton||"取消"),1)]})),_:1})]})),_:1})})),c=n("1da1"),i=(n("96cf"),{name:"SubmitButton",props:["confirmButton","cancelButton","form","reForm"],methods:{saveForm:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.form.$refs[e.reForm].validate((function(t){if(!t)return!1;e.$store.dispatch("UPDATE_ACTIONS",e.form).then((function(){setTimeout((function(){e.$emit("closeDialog")}),500)}))}));case 2:case"end":return t.stop()}}),t)})))()}}});i.render=a,i.__scopeId="data-v-6b545350";t["a"]=i},d81d:function(e,t,n){"use strict";var r=n("23e7"),o=n("b727").map,a=n("1dde"),c=a("map");r({target:"Array",proto:!0,forced:!c},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-547f2ba0.457f087d.js.map