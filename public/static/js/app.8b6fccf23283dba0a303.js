webpackJsonp([1],{"+cgv":function(e,t){},"+nwP":function(e,t){},"+z27":function(e,t){},0:function(e,t){},"3f40":function(e,t){},"3pI4":function(e,t){},"4/hK":function(e,t){},"4EOK":function(e,t){},"4qOc":function(e,t){},"6ZH5":function(e,t){e.exports={agate:1,androidstudio:1,"arduino-light":1,arta:1,ascetic:1,"atelier-cave-dark":1,"atelier-cave-light":1,"atelier-dune-dark":1,"atelier-dune-light":1,"atelier-estuary-dark":1,"atelier-estuary-light":1,"atelier-forest-dark":1,"atelier-forest-light":1,"atelier-heath-dark":1,"atelier-heath-light":1,"atelier-lakeside-dark":1,"atelier-lakeside-light":1,"atelier-plateau-dark":1,"atelier-plateau-light":1,"atelier-savanna-dark":1,"atelier-savanna-light":1,"atelier-seaside-dark":1,"atelier-seaside-light":1,"atelier-sulphurpool-dark":1,"atelier-sulphurpool-light":1,"atom-one-dark":1,"atom-one-light":1,"brown-paper":1,"codepen-embed":1,"color-brewer":1,darcula:1,dark:1,darkula:1,default:1,docco:1,dracula:1,far:1,foundation:1,"github-gist":1,github:1,googlecode:1,grayscale:1,"gruvbox-dark":1,"gruvbox-light":1,hopscotch:1,hybrid:1,idea:1,"ir-black":1,"kimbie.dark":1,"kimbie.light":1,magula:1,"mono-blue":1,"monokai-sublime":1,monokai:1,obsidian:1,ocean:1,"paraiso-dark":1,"paraiso-light":1,pojoaque:1,purebasic:1,qtcreator_dark:1,qtcreator_light:1,railscasts:1,rainbow:1,routeros:1,"school-book":1,"solarized-dark":1,"solarized-light":1,sunburst:1,"tomorrow-night-blue":1,"tomorrow-night-bright":1,"tomorrow-night-eighties":1,"tomorrow-night":1,tomorrow:1,vs:1,vs2015:1,xcode:1,xt256:1,zenburn:1}},"7zJS":function(e,t){},"8Ygm":function(module,exports,__webpack_require__){var md5=__webpack_require__("NC6I"),str_count=function(e,t){var a=void 0,i=[];for(a=e.indexOf(t);a>-1;)i.push(a),a=e.indexOf(t,a+1);return i.length},t=function t(){var times=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],timestamp=arguments[1],date=new Date(timestamp),Y=date.getFullYear(),M=date.getMonth()+1<10?"0"+eval(date.getMonth()+1):date.getMonth()+1,D=date.getDate()<10?"0"+date.getDate():date.getDate(),h=date.getHours()<10?"0"+date.getHours():date.getHours(),m=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes(),s=date.getSeconds()<10?"0"+date.getSeconds():date.getSeconds();return times?Y+"-"+M+"-"+D+" "+h+":"+m+":"+s:Y+"-"+M+"-"+D+".log"},get_timestamp=function(){return Math.round((new Date).getTime()/1e3)},set_time=function(e){return t(!0,e)},repeat_str=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"　　",i=str_count(e,t);return Array(i).join(a)},set_tree=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[];for(var s in t)t[s].pid===a&&(t[s].__child=e(t,t[s].id),i.push(t[s]));return i},set_random=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=void 0;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all"){case"all":t="MNBVCXZASDFGHJKLPOIUYTREWQ0123456789qwertyuioplkjhgfdsazxcvbnm";break;case"number":t="0123456789";break;case"l":t="QWERTYUIOPLKJHGFDSAZXCVBNM";break;case"s":t="zxcvbnmlkjhgfdsaqwertyuiop"}for(var a="",i=0;i<e;i++)a+=str_shuffle(t).substring(0,1);return a},str_shuffle=function(e){for(var t="",a=e.length;a>0;a--){t+=e[Math.random()*(a+1)|0]}return t},set_password=function(e,t){return md5(md5(e)+md5(t))},get_scroll_top=function(){var e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},set_btn_status=function(e,t,a){var i={add:!1,edit:!1,del:!1},s=e.substring(0,e.lastIndexOf("/")+1);switch((a=JSON.parse(a)).indexOf(s+"save")>=0&&(i.add=!0),a.indexOf(s+"update")>=0&&(i.edit=!0),a.indexOf(s+"delete")>=0&&(i.del=!0),t){case"SystemFile":i.chmod=!1,i.gzip=!1,i.unzip=!1,i.download=!1,i.rename=!1,i.upload=!1,a.indexOf(s+"chmod")>=0&&(i.chmod=!0),a.indexOf(s+"gzip")>=0&&(i.gzip=!0),a.indexOf(s+"unzip")>=0&&(i.unzip=!0),a.indexOf(s+"download")>=0&&(i.download=!0),a.indexOf(s+"rename")>=0&&(i.rename=!0),a.indexOf(s+"upload")>=0&&(i.upload=!0);break;case"DatabaseLists":i.backup=!1,i.repair=!1,i.optimize=!1,i.comment=!1,a.indexOf(s+"backup")>=0&&(i.backup=!0),a.indexOf(s+"repair")>=0&&(i.repair=!0),a.indexOf(s+"optimize")>=0&&(i.optimize=!0),a.indexOf(s+"comment")>=0&&(i.comment=!0)}return i},func={str_count:str_count,set_time:set_time,repeat_str:repeat_str,set_tree:set_tree,get_timestamp:get_timestamp,set_random:set_random,str_shuffle:str_shuffle,set_password:set_password,get_scroll_top:get_scroll_top,set_btn_status:set_btn_status};module.exports=func},AnvH:function(e,t){},BbBi:function(e,t){},Bm4g:function(e,t){},Cn0l:function(e,t){},CqVR:function(e,t,a){e.exports=a.p+"static/img/u0.ba54a8c.jpg"},Cw02:function(e,t){},HAel:function(e,t){},HXjg:function(e,t){},HjDx:function(e,t){},IQy7:function(e,t){},"L/RK":function(e,t){},Lgoy:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("pFYg"),s=a.n(i),n=a("8U58");a("4/hK");var o={props:{value:{type:String,default:""},options:{type:Object,default:function(){return{mode:"text/javascript",lineNumbers:!0,lineWrapping:!0}}}},data:function(){return{skipNextChangeEvent:!1}},ready:function(){var e=this;this.editor=n.fromTextArea(this.$el.querySelector("textarea"),this.options),this.editor.setValue(this.value),this.editor.on("change",function(t){e.skipNextChangeEvent?e.skipNextChangeEvent=!1:(e.value=t.getValue(),e.$emit&&e.$emit("change",t.getValue()))})},mounted:function(){var e=this;this.editor=n.fromTextArea(this.$el.querySelector("textarea"),this.options),this.editor.setValue(this.value),this.editor.on("change",function(t){e.skipNextChangeEvent?e.skipNextChangeEvent=!1:e.$emit&&(e.$emit("change",t.getValue()),e.$emit("input",t.getValue()))})},watch:{value:function(e,t){if(e!==this.editor.getValue()){this.skipNextChangeEvent=!0;var a=this.editor.getScrollInfo();this.editor.setValue(e),this.editor.scrollTo(a.left,a.top)}},options:function(e,t){if("object"===(void 0===e?"undefined":s()(e)))for(var a in e)e.hasOwnProperty(a)&&this.editor.setOption(a,e[a])}},beforeDestroy:function(){this.editor&&this.editor.toTextArea()}},r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vue-codemirror-wrap"},[t("textarea")])}]};var l=a("VU/8")(o,r,!1,function(e){a("NAmH")},null,null);t.default=l.exports},MHFj:function(e,t){},NAmH:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),n=a("7+uW"),o=(a("tvR6"),a("zL8q")),r=a.n(o),l={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view",{class:this.ClassName})},staticRenderFns:[]};var c=a("VU/8")({name:"App",provide:function(){return{reload:this.reload}},data:function(){return{ClassName:"clear_box",isRouterAlive:!0}},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0})}}},l,!1,function(e){a("aPY3")},null,null).exports,u=a("/ocq"),d=a("Dd8w"),m=a.n(d),p=a("NYxO"),h=a("woOf"),f=a.n(h),g={authLists:"/v1/auth/index",authSave:"/v1/auth/save",authUpdate:"/v1/auth/update",authDelete:"/v1/auth/delete",roleLists:"/v1/role/index",roleSave:"/v1/role/save",roleUpdate:"/v1/role/update",roleDelete:"/v1/role/delete",userLists:"/v1/user/index",userSave:"/v1/user/save",userUpdate:"/v1/user/update",userDelete:"/v1/user/delete",userCenter:"/v1/user/center",saveUserCenter:"/v1/center/save",userBind:"/v1/user/bind",logLists:"/v1/log/index",logSave:"/v1/log/save",logDelete:"/v1/log/delete",configLists:"/v1/config/index",configSave:"/v1/config/save",configUpdate:"/v1/config/update",configValUpdate:"/v1/config/updateVal",configDelete:"/v1/config/delete",apiLists:"/v1/api/index",apiSave:"/v1/api/save",apiUpdate:"/v1/api/update",apiDocLists:"/v1/apidoc/index",apiDocSave:"/v1/apidoc/save",apiDocUpdate:"/v1/apidoc/update",categoryLists:"/v1/category/index",categorySave:"/v1/category/save",categoryUpdate:"/v1/category/update",categoryDelete:"/v1/category/delete",databaseLists:"/v1/database/index",databaseBackUp:"/v1/database/backup",databaseRepair:"/v1/database/repair",databaseOptimize:"/v1/database/optimize",databaseUpdateComment:"/v1/database/comment",oauthLists:"/v1/oauth/index",oauthUpdate:"/v1/oauth/update",oauthDelete:"/v1/oauth/delete",oauthBind:"/v1/oauth/bind",sendMail:"/v1/oauth/sendMail",verifyCode:"/v1/oauth/verifyCode",chatOauth:"/v1/oauth/chat",reqRuleLists:"/v1/req-rule/index",reqRuleSave:"/v1/req-rule/save",reqRuleUpdate:"/v1/req-rule/update",reqRuleDelete:"/v1/req-rule/delete",getAuthByToken:"/v1/req-rule/getAuth",fileLists:"/v1/file/index",fileRead:"/v1/file/read",fileRename:"/v1/file/rename",fileChmod:"/v1/file/chmod",fileSave:"/v1/file/save",fileDelete:"/v1/file/delete",fileUpdate:"/v1/file/update",fileUpload:"/v1/file/upload",fileDownload:"/v1/file/download",fileCompression:"/v1/file/zip",fileDecompression:"/v1/file/unzip",imagePreview:"/v1/image/preview",areaIndex:"/v1/area/index",areaLists:"/v1/area/lists",areaWeather:"/v1/area/weather",emotionLists:"/v1/emotion/index",chatLists:"/v1/chat/index",pushList:"/v1/push/index",pushSave:"/v1/push/save",pushUpdate:"/v1/push/update",pushRead:"/v1/push/see",pushDelete:"/v1/push/delete",tableComponent:"/v1/components/table",componentAction:"/v1/components/actions",excelExport:"/v1/excel/export",timeLineLists:"/v1/timeline/index",timeLineSave:"/v1/timeline/save",timeLineUpdate:"/v1/timeline/update",tree:"/v1/menu",login:"/v1/login",logout:"/v1/logout",checkToken:"/v1/checkLogin",getConfig:"/v1/config",getCountData:"/v1/total",sendEmail:"/v1/sendEmail",checkCode:"/v1/checkCode"},v=a("//Fk"),b=a.n(v),_=a("mtWM"),y=a.n(_),x={state:{tabs:[{label:"欢迎页",name:"/admin/index"}],currTabs:{label:null,name:null},activeAuthName:"/admin/index"},getters:{tabs:function(e){return e.tabs},currTabs:function(e){return e.currTabs},activeAuthName:function(e){return e.activeAuthName}},mutations:{setTabs:function(e,t){e.tabs.push(t)},setCurrTabs:function(e,t){e.currTabs=t},setActiveAuthName:function(e,t){e.activeAuthName=t},delTabs:function(e,t){e.tabs=t}},actions:{addTabs:function(e,t){var a=e.state,i=e.commit;-1===s()(a.tabs).indexOf(s()(t))&&i("setTabs",t)},addCurrTabs:function(e,t){e.state;var a=e.commit;a("setCurrTabs",t),a("setActiveAuthName",t.label)},deleteTabs:function(e,t){var a=e.state,i=e.commit,s=0;for(var n in a.tabs)t===a.tabs[n].name&&(s=n);a.tabs.splice(s,1),i("delTabs",a.tabs)}}},k={state:{fileTabs:[],currFileObj:{name:null,content:null,path:null,label:null},currSystemLogObj:{}},getters:{fileTabs:function(e){return e.fileTabs},currFileObj:function(e){return e.currFileObj},currSystemLogObj:function(e){return e.currSystemLogObj}},mutations:{setFileTabs:function(e,t){e.fileTabs.push(t)},delFileTabs:function(e,t){e.fileTabs=t},setCurrFileObj:function(e,t){e.currFileObj=t},setCurrSystemLogObj:function(e,t){e.currSystemLogObj=t}},actions:{addFileTabs:function(e,t){var a=e.state,i=e.commit;-1===s()(a.fileTabs).indexOf(s()(t))&&i("setFileTabs",t)},deleteFileTabs:function(e,t){var a=e.state,i=e.commit,s=0;for(var n in a.fileTabs)t===a.fileTabs[n].name&&(s=n);a.fileTabs.splice(s,1),i("delFileTabs",a.fileTabs)},addCurrFileObj:function(e,t){e.state;(0,e.commit)("setCurrFileObj",t)},addCurrSystemLogObj:function(e,t){e.state;(0,e.commit)("setCurrSystemLogObj",t)}}},w={state:{apiVisible:!1,interfaceName:"",apiModel:{},docVisible:!1,docModel:{},docName:""},getters:{apiVisible:function(e){return e.apiVisible},interfaceName:function(e){return e.interfaceName},apiModel:function(e){return e.apiModel},docVisible:function(e){return e.docVisible},docModel:function(e){return e.docModel},docName:function(e){return e.docName}},mutations:{setApiVisible:function(e,t){e.apiVisible=t},setDocVisible:function(e,t){e.docVisible=t},setInterfaceName:function(e,t){e.interfaceName=t},setDocName:function(e,t){e.docName=t},setApiModel:function(e,t){e.apiModel=t},setDocModel:function(e,t){e.docModel=t}},actions:{addApiVisible:function(e,t){e.state;var a=e.commit;a("setApiVisible",t.apiVisible),a("setInterfaceName",t.interfaceName)},addDocVisible:function(e,t){e.state;var a=e.commit;a("setDocVisible",t.docVisible),a("setDocName",t.docName)},addApiModel:function(e,t){e.state,(0,e.commit)("setApiModel",t)},addDocModel:function(e,t){e.state,(0,e.commit)("setDocModel",t)}}},C=a("k3x/"),L=a.n(C),S=a("8Ygm"),M=a.n(S),$=a("DmT9"),T=a.n($),O=(a("NC6I"),{state:{token:localStorage.getItem("token"),socketServer:"",avatarUrl:"",websocketServer:"",username:"",auth_url:"",menuLists:[],oauthConfig:[],role_id:0,uuid:""},getters:{token:function(e){return e.token},username:function(e){return e.username},auth_url:function(e){return e.auth_url},menuLists:function(e){return e.menuLists},oauthConfig:function(e){return e.oauthConfig},socketServer:function(e){return e.socketServer},avatarUrl:function(e){return e.avatarUrl},websocketServer:function(e){return e.websocketServer},role_id:function(e){return e.role_id},uuid:function(e){return e.uuid}},mutations:{setMenuLists:function(e,t){e.menuLists=t},setOauthConfig:function(e,t){e.oauthConfig=t},setAuthUrl:function(e,t){e.auth_url=t},setToken:function(e,t){e.token=t,localStorage.setItem("token",t)},setUserName:function(e,t){e.username=t},setSocketServer:function(e,t){e.socketServer=T()(t)},setAvatarUrl:function(e,t){e.avatarUrl=t},setWebsocketServer:function(e,t){e.websocketServer=new WebSocket(t)},setRoleId:function(e,t){e.role_id=t},setUUID:function(e,t){e.uuid=t}},actions:{loginSystem:function(e,t){e.state;var a=e.commit;N.LoginSys(t).then(function(e){e&&e.data.code===L.a.SUCCESS&&(a("setToken",e.data.item.token),a("setUserName",e.data.item.username),a("setRoleId",e.data.item.role_id),a("setUUID",e.data.item.uuid),zt.push({path:"/admin/index"}))})},getOauthConfig:function(e,t){e.state;var a=e.commit;N.GetConfig({name:t}).then(function(e){e&&e.data.code===L.a.SUCCESS&&a("setOauthConfig",e.data.item)})},getAuthMenu:function(e){var t=e.state,a=e.commit;t.menuLists.length>0?a("setMenuLists",t.menuLists):t.username?N.AuthTree([]).then(function(e){e&&e.data.code===L.a.SUCCESS&&a("setMenuLists",M.a.set_tree(e.data.item))}):zt.push({path:"/login"})},logoutSystem:function(e,t){e.state;var a=e.commit;N.LogoutSys({token:t}).then(function(e){e&&e.data.code===L.a.SUCCESS&&(a("setToken",""),a("setUserName",""),zt.push({path:"/login"}))})},saveSystemLog:function(e,t){var a=e.state;e.commit;t.username=a.username,N.LogSave(t).then(function(e){e&&e.data.code===L.a.SUCCESS&&o.Message.success(e.data.msg)})},checkAuth:function(e,t){var a=e.state;e.commit;if(t.url=t.url.replace("v1","admin"),-1===a.auth_url.indexOf(t.url)&&"/admin/index"!==t.url){var i="你没有访问权限，请联系管理员【"+L.a.QQ+"】检验数据的正确性！";o.MessageBox.alert(i).then(function(){var e={username:a.username,href:[t.url]};N.ReqRuleSave(e).then(function(e){if(e&&e.data.code===L.a.SUCCESS){var n={href:t.url.replace("admin","v1"),msg:s()({info:i,result:e.data.result}),token:a.token};N.LogSave(n).then(function(e){e&&e.data.code===L.a.SUCCESS&&(o.Message.success(e.data.msg),location.href="tencent://message/?uin="+L.a.QQ+"&Site=后台权限认证&Menu=yes")})}})})}}}});n.default.use(p.a);var V=new p.a.Store({modules:{tabs:x,fileTabs:k,api:w,login:O}}),R=y.a.create({timeout:1e4});R.defaults.baseURL="https://www.fanglonger.com/api/",R.interceptors.request.use(function(e){return V.state.login.token&&(e.headers.Authorization=""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+V.state.login.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12))),e},function(e){return b.a.reject(e)}),R.interceptors.response.use(function(e){return 200!==e.data.code&&o.Message.warning(e.data.msg),e},function(e){!function(e,t){switch(e){case 401:V.commit("setToken",""),zt.push({path:"/login"}),o.Message.warning(t);break;case 403:zt.push({path:"/admin/index"}),o.Message.warning(t);break;case 404:zt.push({path:"/404"}),o.Message.warning(t);break;default:o.Message.warning("network error")}}(e.response.data.code,e.response.data.msg)});var D=R,F=a("mw3O"),U=a.n(F),z={token:localStorage.getItem("token")},N={LoginSys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.login,U.a.stringify(f()(e,z)))},LogoutSys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.logout,U.a.stringify(f()(e,z)))},LogSave:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.logSave,U.a.stringify(f()(e,z)))},CheckToken:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.checkToken,U.a.stringify(f()(z,e)))},AuthLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.authLists,U.a.stringify(f()(e,z)))},RoleLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.roleLists,U.a.stringify(f()(e,z)))},AuthTree:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.tree,U.a.stringify(f()(e,z)))},UserLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.userLists,U.a.stringify(f()(e,z)))},UserCenter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.userCenter,U.a.stringify(f()(e,z)))},UserBind:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.userBind,U.a.stringify(f()(e,z)))},LogLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.logLists,U.a.stringify(f()(e,z)))},ApiLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.apiLists,U.a.stringify(f()(e,z)))},ApiDocLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.apiDocLists,U.a.stringify(f()(e,z)))},ApiDocSave:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.apiDocSave,U.a.stringify(f()(e,z)))},ApiDocUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.apiDocUpdate,U.a.stringify(f()(e,z)))},CategoryLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.categoryLists,U.a.stringify(f()(e,z)))},FileLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileLists,U.a.stringify(f()(e,z)))},FileRead:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileRead,U.a.stringify(f()(e,z)))},FileRename:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileRename,U.a.stringify(f()(e,z)))},FileSave:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileSave,U.a.stringify(f()(e,z)))},FileDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileDelete,U.a.stringify(f()(e,z)))},DatabaseLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.databaseLists,U.a.stringify(f()(e,z)))},DatabaseBackup:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.databaseBackUp,U.a.stringify(f()(e,z)))},DatabaseRepair:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.databaseRepair,U.a.stringify(f()(e,z)))},DatabaseOptimize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.databaseOptimize,U.a.stringify(f()(e,z)))},DatabaseUpdateComment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.databaseUpdateComment,U.a.stringify(f()(e,z)))},CategoryDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.categoryDelete,U.a.stringify(f()(e,z)))},Compression:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileCompression,U.a.stringify(f()(e,z)))},Decompression:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.fileDecompression,U.a.stringify(f()(e,z)))},ImagePreview:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.imagePreview,U.a.stringify(f()(e,z)))},ConfigLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.configLists,U.a.stringify(f()(e,z)))},ConfigValUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.configValUpdate,U.a.stringify(f()(e,z)))},GetConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.getConfig,U.a.stringify(f()(e,z)))},OauthLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.oauthLists,U.a.stringify(f()(e,z)))},OauthBind:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.oauthBind,U.a.stringify(f()(e,z)))},ReqRuleLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.reqRuleLists,U.a.stringify(f()(e,z)))},ReqRuleSave:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.reqRuleSave,U.a.stringify(f()(e,z)))},GetAuthByToken:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.getAuthByToken,U.a.stringify(f()(e,z)))},SendEmail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.sendMail;return D.post(t,U.a.stringify(f()(e,z)))},VerifyCode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.verifyCode;return D.post(t,U.a.stringify(f()(e,z)))},AreaLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return D.post(t,U.a.stringify(f()(e,z)))},AreaWeather:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.areaWeather,U.a.stringify(f()(e,z)))},PushList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.pushList,U.a.stringify(f()(e,z)))},PushRead:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.pushRead,U.a.stringify(f()(e,z)))},ChatLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.chatLists,U.a.stringify(f()(e,z)))},EmotionLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.emotionLists,U.a.stringify(f()(e,z)))},GetCountData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.getCountData,U.a.stringify(f()(e,z)))},TableComponents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.tableComponent,U.a.stringify(f()(e,z)))},SaveData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return D.post(t,U.a.stringify(f()(e,z)))},Remove:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return D.post(t,U.a.stringify(f()(e,z)))},ExcelExport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.excelExport,U.a.stringify(f()(e,z)))},TimeLineLists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.timeLineLists,U.a.stringify(f()(e,z)))},ChatOauth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.post(g.chatOauth,U.a.stringify(f()(e,z)))}},A={props:{height:Number},data:function(){return{emotionTypeLists:[{type:"1",title:"表情",id:"emotion"},{type:"2",title:"人物",id:"person"},{type:"3",title:"动作",id:"action"},{type:"4",title:"家庭",id:"family"},{type:"5",title:"自然",id:"natural"},{type:"6",title:"食物",id:"food"},{type:"7",title:"体育",id:"sport"},{type:"8",title:"建筑",id:"building"},{type:"9",title:"用品",id:"supplies"},{type:"10",title:"符号",id:"symbol"},{type:"11",title:"国旗",id:"flag"}],type:"1",emotionList:[],limit:55,page:1,pages:0}},methods:{changeEmotionLists:function(e){this.type=e.name,this.page=1,this.emotionList=[],this.showEmotionLists(this.page,this.limit)},clickHandler:function(e){this.$emit("clickEmotion",e)},showEmotionLists:function(e,t){var a=this;N.EmotionLists({type:this.type,limit:t,page:e}).then(function(e){a.pages=e.data.item.pages;var t=e.data.item.data;for(var i in t)a.emotionList.push(t[i])})},scrollEmotion:function(){this.page<=this.pages&&(this.page=this.page+1,this.showEmotionLists(this.page,this.limit))}},mounted:function(){this.$nextTick(function(){this.showEmotionLists(this.page,this.limit)})}},q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"emotion"},[a("div",{staticClass:"emotion-box",style:{height:e.height+"px"}},[a("el-tabs",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.scrollEmotion,expression:"scrollEmotion"}],attrs:{type:"border-card","tab-position":"top"},on:{"tab-click":e.changeEmotionLists},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.emotionTypeLists,function(t,i){return a("el-tab-pane",{key:i,attrs:{name:t.type,label:t.title}},e._l(e.emotionList,function(t,i){return a("div",{key:i,staticClass:"emotion-box-line"},[a("div",{staticClass:"emotion-item"},[a("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:t.icon,alt:t.title,lazy:""},nativeOn:{click:function(a){return e.clickHandler(t)}}})],1)])}),0)}),1)],1)])},staticRenderFns:[]};var E={name:"baseModule",inject:["reload"],data:function(){return{isCollapse:!1,activeName:null,activeIndex:"1",menuClass:"el-icon-s-unfold",asideWidth:"200px",asideHeight:{},headerStyle:{"margin-left":"200px"},noticeLength:0,notice:[],online:0,cgi:{uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload},chatTitle:"隨心所欲,隨性而行",fileData:{},headers:{},chatVisible:!1,client_list:[],inputMsg:"",emotionLists:[],showEmotion:!1,closeModel:!1,center:!0,messageLists:[],msg_type:"text",to_client_name:"all",to_client_id:"all",avatar_url:"",chatMsgClass:"el-icon-chat-dot-round",msg_dot:!1,room_id:"1200",noticeArr:[]}},components:{emotion:a("VU/8")(A,q,!1,function(e){a("vv6C")},"data-v-9428d136",null).exports},computed:m()({},Object(p.c)(["tabs","token","username","activeAuthName","menuLists","socketServer","avatarUrl","websocketServer","oauthConfig","uuid"])),methods:m()({},Object(p.b)(["addTabs","deleteTabs","addCurrTabs","logoutSystem","getAuthMenu","getOauthConfig"]),{unescape:function(e){return e.replace(e?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;nbsp;/g," ").replace(/&#39;/g,"'")},setAttr:function(e){var t={label:e.name,name:e.href};this.activeName=t.name,this.addCurrTabs(t),this.addTabs(t),this.asideHeight={"min-height":window.innerHeight-60+"px"},this.$router.push({path:t.name})},goto:function(e){this.$router.push({path:e.name})},remove:function(e){var t=this;this.tabs.forEach(function(a,i){if(a.name===e){var s=t.tabs[i+1]||t.tabs[i-1];s&&(t.deleteTabs(e),t.activeName=s.name,t.$router.push({path:t.activeName}),t.addCurrTabs(s))}})},handleSelect:function(e,t){switch(e){case"2-1":var a={label:"个人中心",name:"/admin/user/center"};this.activeName=a.name,this.addCurrTabs(a),this.addTabs(a),this.$router.push({path:a.name});break;case"2-2":this.logoutSystem(this.token)}},readNotice:function(e){if("more"===e){var t={label:"站内通知",name:"/admin/push/index"};return this.activeName=t.name,this.addCurrTabs(t),this.addTabs(t),this.$router.push({path:t.name}),!1}var a={};a.see=parseInt(e.see)+1,a.id=e.id,a.type=e.type,N.PushRead(a)},hideMenu:function(){this.isCollapse=!this.isCollapse,this.isCollapse?(this.menuClass="el-icon-s-fold",this.asideWidth="65px",this.headerStyle={"margin-left":"65px"}):(this.menuClass="el-icon-s-unfold",this.asideWidth="200px",this.headerStyle={"margin-left":"200px"})},getMsgDialog:function(){if(this.chatVisible=!this.chatVisible,this.chatVisible){this.chatMsgClass="el-icon-close";var e={type:"history",from_client_name:this.username,to_client_name:this.to_client_name,room_id:"all"===this.to_client_name?this.room_id:""};this.websocketServer.send(s()(e)),this.getOauthConfig("RoomLists"),this.scrollToBottom(),this.msg_dot=!1}else this.chatMsgClass="el-icon-chat-dot-round"},setRoomID:function(e){this.showEmotion=!1,this.room_id=e.id.toString(),this.chatTitle=e.value;var t={type:"login",client_name:this.username,room_id:this.room_id,client_img:this.avatarUrl,uid:this.uuid};this.websocketServer.send(s()(t));var a={type:"history",from_client_name:this.username,to_client_name:"all",room_id:this.room_id};this.websocketServer.send(s()(a)),this.scrollToBottom()},connect:function(e){var t=this;e.onopen=function(){var a={type:"login",client_name:t.username,room_id:t.room_id,client_img:t.avatarUrl,uid:t.uuid};e.send(s()(a))},e.onmessage=function(a){var i=JSON.parse(a.data);switch(i.type){case"ping":e.send('{"type":"pong"}');break;case"login":t.client_list={},i.client_list?t.client_list=i.client_list:t.client_list[i.client_id]=i.client_name;break;case"say":t.say(i);break;case"history":t.messageLists=i.message;break;case"logout":console.log(i)}},e.onclose=function(){console.log("连接关闭，定时重连"),t.connect(e)},e.onerror=function(){console.log("出现错误")}},sendUser:function(e,t){this.to_client_name=e.client_name,this.to_client_id="0"===t?"all":t,this.chatTitle="all"===e.client_name?"ChatRoom":e.client_name,this.avatar_url=this.avatarUrl;var a={type:"history",from_client_name:this.username,to_client_name:this.to_client_name,room_id:""};this.websocketServer.send(s()(a)),this.scrollToBottom()},setMsg:function(){this.inputMsg=this.$refs.message.innerHTML},getEmotion:function(e){this.msg_type="text",this.inputMsg+="<img src='"+e.icon+"' width='50px' height='50px' alt='"+e.emoji+"' title='"+e.title+"'>",this.$refs.message.innerHTML=this.inputMsg},uploadSuccess:function(e){if(e&&200===e.code){switch(this.msg_type){case"img":this.inputMsg+="<img src='"+e.item.src+"' width='100px' height='100px' alt=''>";break;case"video":this.inputMsg+="<video src='"+e.item.src+"' width='200px' height='200px' controls='controls'>"}this.$refs.message.innerHTML=this.inputMsg}else this.$message({type:"warning",message:e.msg})},beforeUpload:function(e){switch(e.name.split(".")[1].toLocaleLowerCase()){case"jpg":case"gif":case"png":case"jpeg":this.msg_type="img",e.size>2097152&&this.$message({type:"warning",message:"upload image size error"});break;case"mp4":this.msg_type="video",e.size>5242880&&this.$message({type:"warning",message:"upload video size error"});break;default:this.$message({type:"warning",message:"Unsupported file format"})}},say:function(e){var t={type:"history",from_client_name:e.from_client_name,to_client_name:e.to_client_name,room_id:e.room_id,page:this.page,limit:this.limit};this.websocketServer.send(s()(t)),this.messageLists.push(e),this.username!==e.from_client_name&&("all"!==e.to_client_id&&(this.chatTitle=e.from_client_name,this.to_client_name=e.from_client_name,this.to_client_id=e.from_client_id),this.msg_dot=!0),this.chatVisible&&this.username===e.from_client_name&&("all"!==e.to_client_id&&(this.chatTitle=e.to_client_name,this.to_client_name=e.to_client_name,this.to_client_id=e.to_client_id),this.scrollToBottom())},sendMsg:function(){if(this.showEmotion=!1,this.inputMsg=void 0!==this.$refs.message?this.$refs.message.innerHTML:"",""!==this.inputMsg.trim()){var e={type:"say",to_client_id:this.to_client_id,to_client_name:this.to_client_name,from_client_name:this.username,msg_type:this.msg_type,content:this.inputMsg,avatar_url:this.avatar_url,room_id:"all"===this.to_client_name?this.room_id:""};this.websocketServer.send(s()(e));var t={type:"history",from_client_name:this.username,to_client_name:this.to_client_name,room_id:"all"===this.to_client_name?this.room_id:""};return this.websocketServer.send(s()(t)),this.messageLists.push(e),this.scrollToBottom(),this.$refs.message.innerHTML="",void(this.inputMsg="")}this.chatVisible&&(this.$refs.message.focus(),this.$message({type:"info",message:"Please enter message"}))},webPush:function(){var e=this;this.socketServer.on("connect",function(){e.socketServer.emit("login",e.uuid)}),this.socketServer.on("new_msg",function(t){e.noticeArr.push({time:M.a.get_timestamp(),message:t})}),this.socketServer.on("notice",function(t){var a=1;for(var i in e.noticeLength=0,t)t[i].disabled=!0,"successfully"!==t[i].status&&0===t[i].see&&(t[i].disabled=!1,e.noticeLength=a++);e.notice=t}),this.socketServer.on("online",function(t){e.online=t})},closeNotice:function(e){for(var t in this.noticeArr)this.noticeArr[t].time===e.time&&this.noticeArr.splice(t,1);console.log(this.noticeArr)},scrollToBottom:function(){var e=this;this.$nextTick(function(){var t=document.getElementById("msg");try{t.scrollTop=t.scrollHeight}catch(t){e.$message.error(s()(t))}})}}),created:function(){this.activeName=this.activeAuthName,this.asideHeight={"min-height":window.innerHeight-60+"px"},this.avatar_url=this.avatarUrl,this.fileData.token=this.token,this.fileData.rand=!1,this.headers.Authorization=""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+this.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12)),this.connect(this.websocketServer);var e=this;document.onkeydown=function(t){if("Enter"===t.code&&t.shiftKey)return t.preventDefault(),e.sendMsg(),!1}},watch:{chatVisible:function(){this.chatVisible||(this.chatMsgClass="el-icon-chat-dot-round")},inputMsg:function(){this.inputMsg=this.$refs.message.innerHTML}},mounted:function(){this.$nextTick(function(){var e={label:this.$route.meta.title,name:this.$route.path};this.activeName=e.name,this.addCurrTabs(e),this.addTabs(e),this.getAuthMenu(),this.webPush()})}},j={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",[a("el-menu",{style:e.headerStyle,attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#393d49","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"1"},on:{click:e.hideMenu}},[a("i",{class:e.menuClass,staticStyle:{color:"#fff","font-size":"25px"}})]),e._v(" "),a("el-submenu",{staticStyle:{float:"right"},attrs:{index:"2"}},[a("template",{slot:"title"},[a("el-avatar",{attrs:{src:e.avatarUrl,alt:e.username,size:35}}),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"},domProps:{innerHTML:e._s(e.username)}})],1),e._v(" "),a("el-menu-item",{attrs:{index:"2-1"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v(" 个人中心")]),e._v(" "),a("el-menu-item",{attrs:{index:"2-2"}},[a("i",{staticClass:"el-icon-upload2"}),e._v(" 退出系统")])],2),e._v(" "),a("el-menu-item",{staticStyle:{float:"right"},attrs:{index:"3"}},[a("el-dropdown",{attrs:{trigger:"hover","hide-on-click":!1,"show-timeout":100},on:{command:e.readNotice}},[a("i",{staticClass:"el-icon-message-solid",staticStyle:{color:"#fff","font-size":"22px"}}),e._v(" "),e.noticeLength?a("el-badge",{staticStyle:{"margin-top":"-30px","margin-left":"-18px"},attrs:{value:e.noticeLength}}):e._e(),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{staticStyle:{"text-align":"center",color:"#66b1ff"}},[e._v("站内通知")]),e._v(" "),e._l(e.notice,function(t,i){return a("el-dropdown-item",{key:i,attrs:{command:t,divided:"",disabled:t.disabled}},[t.disabled?e._e():a("el-badge",{attrs:{"is-dot":""}}),e._v("【"+e._s(t.title)+"】 "+e._s(t.info)+"\n                        ")],1)}),e._v(" "),a("el-dropdown-item",{staticStyle:{"text-align":"center",color:"#66b1ff"},attrs:{command:"more"}},[e._v("查看更多")])],2)],1)],1),e._v(" "),a("el-menu-item",{staticStyle:{float:"right"},attrs:{index:"4"}},[a("a",{attrs:{href:"https://gitee.com/f_longer/vue-app",target:"_blank"}},[a("img",{attrs:{src:"https://gitee.com/f_longer/longer/widgets/widget_5.svg?color=C71D24",alt:"gitee"}})])])],1)],1),e._v(" "),a("el-container",[a("el-aside",{style:e.asideHeight,attrs:{width:e.asideWidth}},[a("el-menu",{attrs:{"unique-opened":"","background-color":"#393d49","text-color":"#fff","active-text-color":"#ffd04b",collapse:e.isCollapse}},e._l(e.menuLists,function(t,i){return a("el-submenu",{key:i,attrs:{index:t.id.toString()}},[a("template",{slot:"title"},[2!==t.id?a("i",{staticClass:"el-icon-menu"}):e._e(),e._v(" "),a("span",{domProps:{innerHTML:e._s(t.name)}})]),e._v(" "),e._l(t.__child,function(t,i){return a("el-menu-item",{key:i,attrs:{index:t.id.toString()},on:{click:function(a){return e.setAttr(t)}}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-home"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(t.name)}})])],2)})],2)}),1)],1),e._v(" "),a("el-container",{attrs:{direction:"vertical"}},[a("el-main",[e.noticeArr.length>0?a("el-carousel",{attrs:{interval:2e3,arrow:"never",height:"50px",direction:"vertical","indicator-position":"none"}},e._l(e.noticeArr,function(t,i){return a("el-carousel-item",{key:i},[a("el-alert",{attrs:{type:"success","show-icon":"",title:t.message,effect:"light"},on:{close:function(a){return e.closeNotice(t)}}})],1)}),1):e._e(),e._v(" "),a("el-tabs",{attrs:{type:"border-card",closable:"",lazy:""},on:{"tab-click":e.goto,"tab-remove":e.remove},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e._l(e.tabs,function(e){return a("el-tab-pane",{key:e.name,attrs:{label:e.label,name:e.name}})}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("router-view")],1)],2)],1),e._v(" "),a("el-footer",[e._v("\n                ©fl140125@gmail.com 在线人数："+e._s(e.online)+"\n            ")]),e._v(" "),a("i",{staticClass:"msg-icon",on:{click:e.getMsgDialog}},[a("i",{class:e.chatMsgClass,staticStyle:{margin:"13px 15px"}},[e.msg_dot?a("el-badge",{staticClass:"msg-count",attrs:{"is-dot":"",type:"danger"}}):e._e()],1)])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.chatTitle,top:"5vh",width:"957px",center:e.center,"show-close":e.closeModel,"close-on-press-escape":e.closeModel,visible:e.chatVisible},on:{close:function(t){e.chatVisible=!1},"update:visible":function(t){e.chatVisible=t}}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticClass:"user-list",attrs:{span:6}},[a("el-aside",[a("el-menu",{attrs:{"background-color":"#393d49","text-color":"#fff","active-text-color":"#ffd04b"}},e._l(e.client_list,function(t,i){return a("el-menu-item",{key:i,attrs:{index:i.toString()},on:{click:function(a){return e.sendUser(t,i)}}},[a("el-avatar",{staticStyle:{cursor:"pointer"},attrs:{size:50,src:t.client_img}}),e._v(" "),a("span",{staticStyle:{"margin-left":"20px"},attrs:{slot:"title"},domProps:{innerHTML:e._s(t.client_name)},slot:"title"})],1)}),1)],1)],1),e._v(" "),a("el-col",{attrs:{offset:1,span:17}},[a("el-card",{attrs:{shadow:"always"}},[a("div",{attrs:{id:"msg"}},e._l(e.messageLists,function(t,i){return a("div",{key:i},[a("div",{staticClass:"msg-img"},[a("el-avatar",{staticStyle:{cursor:"pointer"},attrs:{size:50,src:t.avatar_url}}),e._v(" "),a("i",[e._v(e._s(t.from_client_name)+"   "+e._s(t.time))])],1),e._v(" "),a("div",{staticClass:"msg-list",domProps:{innerHTML:e._s(e.unescape(t.content))}})])}),0),e._v(" "),a("div",{staticClass:"input-msg"},[a("emotion",{directives:[{name:"show",rawName:"v-show",value:e.showEmotion,expression:"showEmotion"}],attrs:{height:300},on:{clickEmotion:e.getEmotion}}),e._v(" "),a("div",[a("el-tooltip",{attrs:{effect:"dark",content:"房间名称",placement:"top-start"}},[a("el-menu",{staticStyle:{"margin-bottom":"10px",border:"none"},attrs:{"default-active":e.room_id,mode:"horizontal"}},e._l(e.oauthConfig,function(t,i){return a("el-menu-item",{key:i,attrs:{index:t.id.toString()},on:{click:function(a){return e.setRoomID(t)}}},[e._v("\n                                        "+e._s(t.value)+"\n                                    ")])}),1)],1),e._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"发送表情",placement:"top-start"}},[a("i",{staticClass:"el-icon-picture-outline-round icon",on:{click:function(t){e.showEmotion=!e.showEmotion}}})]),e._v(" "),a("el-upload",{staticStyle:{float:"left"},attrs:{action:e.cgi.uploadUrl,data:e.fileData,headers:e.headers,"show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload}},[a("el-tooltip",{attrs:{effect:"dark",content:"发送文件和图片",placement:"top-start"}},[a("i",{staticClass:"el-icon-picture-outline icon"})])],1)],1),e._v(" "),a("div",{ref:"message",attrs:{contentEditable:"true",id:"content"},on:{focus:function(t){e.showEmotion=!1},keydown:e.setMsg}})],1),e._v(" "),a("div",{staticClass:"input-button",staticStyle:{"text-align":"right"}},[a("el-tooltip",{attrs:{effect:"dark",content:"Shift + Enter 快捷发送",placement:"top-start"}},[a("el-button",{attrs:{type:"primary",round:"",plain:"",size:"medium"},on:{click:e.sendMsg}},[e._v("发 送")])],1)],1)])],1)],1)],1)],1)},staticRenderFns:[]};var B={name:"index",data:function(){return{}},components:{baseModule:a("VU/8")(E,j,!1,function(e){a("gYeU")},"data-v-7241dd28",null).exports}},I={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-row",{attrs:{gutter:24}},[t("baseModule")],1)},staticRenderFns:[]},P=a("VU/8")(B,I,!1,null,null,null).exports,W=a("XLwt"),H=a.n(W),G={name:"index",data:function(){return{access_token:"",showTimestamp:"",charts:{},xAxisData:[],seriesData:{log:[],notice:[],oauth:[]},reverse:!1,activities:"",value:new Date}},computed:m()({},Object(p.c)(["socketServer"])),methods:m()({},Object(p.d)(["setToken"]),{totalCharts:function(){var e=this;N.GetCountData({}).then(function(t){e.activities=t.data.item.timeline.data,H.a.init(document.getElementById("total")).setOption({title:{text:"数据统计总量",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{feature:{saveAsImage:{}}},legend:{orient:"vertical",left:"left",data:["授权用户","站内通知","日志记录"]},series:[{name:"数据占比",type:"pie",radius:"55%",center:["50%","60%"],data:e.setChartsData(t.data.item),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})})},setChartsData:function(e){var t=[];for(var a in e)"oauthUser"===a&&t.push({value:e[a],name:"授权用户"}),"push"===a&&t.push({value:e[a],name:"站内通知"}),"systemLog"===a&&t.push({value:e[a],name:"日志记录"});return t}}),created:function(){this.$route.params.access_token&&(this.access_token=this.$route.params.access_token)},mounted:function(){this.$nextTick(function(){var e=this;this.totalCharts(),this.access_token&&this.setToken(this.access_token),this.echarts=H.a.init(document.getElementById("charts")),this.socketServer.on("charts",function(t){e.xAxisData=t.day,e.seriesData.log=t.total.log,e.seriesData.notice=t.total.push,e.seriesData.oauth=t.total.oauth,e.echarts.setOption({title:{text:"数据统计"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#688583"}}},legend:{data:["授权用户","站内通知","系统日志"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:e.xAxisData},yAxis:{type:"value"},series:[{name:"授权用户",type:"line",stack:"总量",areaStyle:{normal:{}},data:e.seriesData.oauth},{name:"站内通知",type:"line",stack:"总量",areaStyle:{normal:{}},data:e.seriesData.notice},{name:"系统日志",type:"line",stack:"总量",areaStyle:{normal:{}},data:e.seriesData.log}]})})})}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:14}},[a("div",{staticStyle:{height:"400px"},attrs:{id:"charts"}}),e._v(" "),a("div",{staticStyle:{height:"400px"},attrs:{id:"total"}}),e._v(" "),a("el-calendar",{attrs:{"first-day-of-week":7},scopedSlots:e._u([{key:"dateCell",fn:function(t){t.date;var i=t.data;return[a("p",{class:i.isSelected?"is-selected":""},[e._v("\n                   "+e._s(i.day.split("-").slice(2).join("-"))+" "+e._s(i.isSelected?" ✔️":"")+"\n                ")])]}}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"block"},[a("div",{staticClass:"radio"},[a("el-radio-group",{model:{value:e.reverse,callback:function(t){e.reverse=t},expression:"reverse"}},[a("el-radio",{attrs:{label:!0}},[e._v("倒序")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("正序")])],1)],1),e._v(" "),a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.activities,function(t,i){return a("el-timeline-item",{key:i,attrs:{type:t.type,placement:"top",timestamp:t.timestamp}},[a("el-card",[e._v(e._s(t.content))])],1)}),1)],1)])],1)},staticRenderFns:[]};var K=a("VU/8")(G,Y,!1,function(e){a("Z3i/")},"data-v-2a129f93",null).exports,J=a("RRo+"),Q=a.n(J),Z={name:"login",data:function(){return{passwordLogin:{email:"",password:"",loginType:"password"},passwordRules:{email:[{required:!0,message:"用户名必须",trigger:"blur"}],password:[{required:!0,message:"用户密码必须",trigger:"blur"}]},mailLogin:{email:"",verify_code:"",loginType:"mail"},mailRules:{email:[{required:!0,message:"用户名必须",trigger:"blur"}],verify_code:[{required:!0,message:"验证码必须",trigger:"blur"}]},bgStyle:{background:"url("+a("CqVR")+")","background-repeat":"no-repeat",height:window.innerHeight+"px"},activeModel:"password",codeValue:"获取验证码",times:60,disabled:!1}},computed:m()({},Object(p.c)(["oauthConfig"])),methods:m()({},Object(p.b)(["loginSystem","getOauthConfig"]),{onSubmit:function(e){var t=this;this.$refs[e].validate(function(a){if(a)switch(e){case"password":t.loginSystem(t.passwordLogin);break;case"mail":t.loginSystem(t.mailLogin)}})},getTabs:function(e){"oauth"===e.name&&this.getOauthConfig("oauth")},getEmailCode:function(){var e=this;if(!this.mailLogin.email)return this.$refs.email.focus(),void this.$message.warning("Please Enter Email");if(this.disabled)this.codeValue=this.times--+" s";else{var t={email:this.mailLogin.email};N.SendEmail(t,g.sendEmail).then(function(t){t&&200===t.data.code&&(e.$message({type:"success",message:t.data.msg}),e.disabled=!0)})}},checkCode:function(){var e=this;if(!this.mailLogin.verify_code)return this.$refs.code.focus(),void this.$message.warning("Please Enter Code");if(!Q()(this.mailLogin.verify_code))return this.$refs.code.focus(),void this.$message.warning("verification code format error");if(this.mailLogin.verify_code.length>6)return this.$refs.code.focus(),void this.$message.warning("Wrong verification code length");var t={verify_code:this.mailLogin.verify_code,email:this.mailLogin.email};N.VerifyCode(t,g.checkCode).then(function(t){t&&200===t.data.code?e.$message({type:"success",message:t.data.msg}):e.mailLogin.verify_code=""})},oauthLogin:function(e){window.open(e,"_self")},resetForm:function(e){this.$refs[e].resetFields()}}),created:function(){var e=this;setInterval(function(){e.times>=0&&!0===e.disabled?e.getEmailCode():(e.codeValue="获取验证码",e.disabled=!1,e.times=60)},1e3)}},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{style:e.bgStyle},[a("el-row",{staticStyle:{"padding-top":"8%"},attrs:{gutter:24}},[a("el-col",{attrs:{xl:{span:8,offset:8},lg:{span:12,offset:6},md:{span:16,offset:4},sm:{span:20,offset:"2"},xs:{span:24}}},[a("el-header",{staticStyle:{"text-align":"center","font-size":"20px"}},[e._v("登录系统")]),e._v(" "),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.getTabs},model:{value:e.activeModel,callback:function(t){e.activeModel=t},expression:"activeModel"}},[a("el-tab-pane",{attrs:{label:"账号密码登录",name:"password"}},[a("el-main",[a("el-form",{ref:"password",attrs:{model:e.passwordLogin,rules:e.passwordRules}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"email",autocomplete:"off"},model:{value:e.passwordLogin.email,callback:function(t){e.$set(e.passwordLogin,"email","string"==typeof t?t.trim():t)},expression:"passwordLogin.email"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"el-icon-s-custom"})])],2)],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"password",autocomplete:"off"},model:{value:e.passwordLogin.password,callback:function(t){e.$set(e.passwordLogin,"password","string"==typeof t?t.trim():t)},expression:"passwordLogin.password"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"el-icon-user-solid"})])],2)],1)],1),e._v(" "),a("el-footer",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{plain:""},on:{click:function(t){return e.resetForm("password")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.onSubmit("password")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"邮箱验证登录",name:"email"}},[a("el-main",[a("el-form",{ref:"mail",attrs:{model:e.mailLogin,rules:e.mailRules}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{ref:"email",attrs:{type:"email",placeholder:"email",autocomplete:"off"},model:{value:e.mailLogin.email,callback:function(t){e.$set(e.mailLogin,"email","string"==typeof t?t.trim():t)},expression:"mailLogin.email"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"el-icon-s-custom"})])],2)],1),e._v(" "),a("el-form-item",{attrs:{prop:"verify_code"}},[a("el-input",{ref:"code",attrs:{maxlength:"8",type:"text",placeholder:"verify code",autocomplete:"off"},on:{blur:e.checkCode},model:{value:e.mailLogin.verify_code,callback:function(t){e.$set(e.mailLogin,"verify_code",e._n(t))},expression:"mailLogin.verify_code"}},[a("el-button",{attrs:{slot:"append",disabled:e.disabled},on:{click:e.getEmailCode},slot:"append"},[e._v(e._s(e.codeValue))])],1)],1)],1),e._v(" "),a("el-footer",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{plain:""},on:{click:function(t){return e.resetForm("mail")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.onSubmit("mail")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"账户授权登录",name:"oauth"}},e._l(e.oauthConfig,function(t,i){return 1===t.status?a("el-button",{key:i,staticStyle:{"margin-bottom":"10px"},attrs:{plain:"",type:"primary"},on:{click:function(a){return e.oauthLogin(t.value)}}},[e._v("\n                        "+e._s(t.name.toUpperCase())+"\n                    ")]):e._e()}),1)],1)],1)],1)],1)},staticRenderFns:[]};var ee=a("VU/8")(Z,X,!1,function(e){a("HjDx")},"data-v-c822890a",null).exports,te={name:"Submit",props:{reFrom:String,model:Object,url:String,refs:Object},data:function(){return{}},methods:m()({},Object(p.b)(["saveSystemLog","checkAuth"]),{submitForm:function(e){var t=this;this.refs[e].validate(function(e){if(e)return t.checkAuth({url:t.url}),t.model.token=t.$store.state.login.token,t.$http.post(t.url,t.model).then(function(e){if(e&&200===e.data.code){var a={href:t.url,msg:e.data.msg,token:t.$store.state.login.token};return t.saveSystemLog(a),t.$message({type:"success",message:e.data.msg}),t.$emit("success"),!1}},function(e){console.log(e)}),!0;t.$message({type:"warning",message:"请检查字段完整性~"})})},resetForm:function(e){this.refs[e].resetFields()}})},ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{plain:""},on:{click:function(t){return e.resetForm(e.reFrom)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.submitForm(e.reFrom)}}},[e._v("确 定")])],1)},staticRenderFns:[]};var ie=a("VU/8")(te,ae,!1,function(e){a("kNMa")},"data-v-60c7e962",null).exports,se={name:"Radio",props:{item:Object,url:String},data:function(){return{table:this.$route.meta.mode}},methods:m()({},Object(p.b)(["saveSystemLog","checkAuth"]),{setStatus:function(e){var t=this;this.checkAuth({url:this.url});var a={status:e.status,id:e.id,token:this.$store.state.login.token,act:"status"};this.$http.post(this.url,a).then(function(i){if(i&&200===i.data.code){var s={href:t.url,msg:i.data.msg,token:t.$store.state.login.token};return t.saveSystemLog(s),t.$message({type:"success",message:i.data.msg}),void t.$emit("success")}e.status=1===parseInt(a.status)?2:1},function(t){e.status=1===parseInt(a.status)?2:1,console.log(t)})}})},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tooltip",{attrs:{content:"look before you leap",placement:"top"}},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(t){return e.setStatus(e.item)}},model:{value:e.item.status,callback:function(t){e.$set(e.item,"status",t)},expression:"item.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("否")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("是")])],1)],1)},staticRenderFns:[]};var oe=a("VU/8")(se,ne,!1,function(e){a("mIMO")},"data-v-7d853704",null).exports,re={name:"Delete",props:{item:Object,url:String,index:Number,Lists:Array},data:function(){return{table:this.$route.meta.mode}},methods:m()({},Object(p.b)(["saveSystemLog","checkAuth"]),{remove:function(e,t){var a=this;this.$confirm("此操作将永远删除该条记录，是否继续？","删除记录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.checkAuth({url:a.url});var i={id:e.id,token:a.$store.state.login.token};a.$http.post(a.url,i).then(function(e){if(e&&200===e.data.code){a.Lists.splice(t,1);var i={href:a.url,msg:e.data.msg,token:a.$store.state.login.token};return a.saveSystemLog(i),a.$message({type:"success",message:e.data.msg}),a.$emit("success"),!1}},function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"cancel delete！"})})}})},le={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tooltip",{attrs:{content:"look before you leap",placement:"top"}},[a("el-button",{attrs:{plain:"",type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.remove(e.item,e.index)}}},[e._v("删 除")])],1)},staticRenderFns:[]};var ce=a("VU/8")(re,le,!1,function(e){a("AnvH")},"data-v-39004e3e",null).exports,ue={name:"lists",components:{Delete:ce,Radio:oe,Submit:ie},data:function(){return{authLists:[],authLevel:[],search:"",syncVisible:!1,modal:!0,center:!0,labelWidth:"80px",title:"",loading:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"auth",act:"",authModel:{},cgi:{insert:g.authSave,update:g.authUpdate,remove:g.authDelete,status:g.authUpdate},rules:{name:[{required:!0,message:"权限名称不得为空",trigger:"blur"}],href:[{required:!0,message:"权限链接不得为空",trigger:"blur"}],pid:[{required:!0,message:"权限上级不得为空",trigger:"change"}],status:[{required:!0,message:"权限状态不得为空",trigger:"change"}]},btn:{},id:0}},computed:m()({},Object(p.c)(["username"])),methods:{success:function(){this.getAuthLists(this.id),this.syncVisible=!1},getAuthLists:function(e){var t=this;N.AuthLists({id:e}).then(function(e){e&&200===e.data.code&&(t.authLists=e.data.item.authLists,t.authLevel=e.data.item.selectAuth,t.loading=!1)})},load:function(e,t,a){N.AuthLists({id:e.id}).then(function(e){e&&200===e.data.code&&setTimeout(function(){a(e.data.item.authLists)},500)})},setAuthName:function(e){return Array(e.level+1).join("　　")+e.name},addAuth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.syncVisible=!0,this.title="添加权限",this.url=this.cgi.insert,this.act="add",this.authModel={name:"",href:"",status:"1",pid:"0",level:0,path:"1"},e.name&&(this.authModel.pid=e.id.toString())},updateAuth:function(e){this.syncVisible=!0,this.title="修改权限",this.url=this.cgi.update,this.authModel=e,this.act="update",this.authModel.pid=this.authModel.pid.toString()}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getAuthLists(this.id)})}},de={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[e.btn.add?a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addAuth}},[e._v("添 加")])],1)],1):e._e(),e._v(" "),a("el-table",{attrs:{data:e.authLists.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())||t.href.includes(e.search.toLowerCase())}),"row-key":"id",lazy:"",load:e.load,"tree-props":{children:"__child",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{label:"权限名称",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"权限链接",prop:"href"}}),e._v(" "),e.btn.edit?a("el-table-column",{attrs:{label:"显示状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Radio",{attrs:{item:t.row,url:e.cgi.status}})]}}],null,!1,2058033001)}):e._e(),e._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.level<=1&&e.btn.add?a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"mini",plain:""},on:{click:function(a){return e.addAuth(t.row)}}},[e._v("添 加")]):e._e(),e._v(" "),e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateAuth(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.authLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.authModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"权限名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"权限名称"},model:{value:e.authModel.name,callback:function(t){e.$set(e.authModel,"name",t)},expression:"authModel.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限链接",prop:"href"}},[a("el-input",{attrs:{placeholder:"/admin/auth/lists"},model:{value:e.authModel.href,callback:function(t){e.$set(e.authModel,"href",t)},expression:"authModel.href"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限上级",prop:"pid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"权限上级",filterable:""},model:{value:e.authModel.pid,callback:function(t){e.$set(e.authModel,"pid",t)},expression:"authModel.pid"}},["0"===e.authModel.pid?a("el-option",{attrs:{label:"默认权限",value:"0",selected:""}}):e._e(),e._v(" "),e._l(e.authLevel,function(t,i){return a("el-option",{key:i,attrs:{label:e.setAuthName(t),value:t.id.toString()}})})],2)],1),e._v(" "),"add"===e.act?a("el-form-item",{attrs:{label:"权限状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.authModel.status,callback:function(t){e.$set(e.authModel,"status",t)},expression:"authModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.authModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var me=a("VU/8")(ue,de,!1,function(e){a("3pI4")},"data-v-64acc342",null).exports,pe={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe},data:function(){return{roleLists:[],loading:!0,loadingText:"玩命加载中。。。",authLists:[],defaultChecked:[],search:"",limit:15,page:1,total:0,title:"",syncVisible:!1,modal:!0,labelWidth:"80px",center:!0,url:"",refs:this.$refs,reFrom:"role",act:"",roleModel:{},ids:[],urls:[],cgi:{insert:g.roleSave,update:g.roleUpdate,remove:g.roleDelete,status:g.roleUpdate},rules:{role_name:[{required:!0,message:"角色名称不得为空",trigger:"blur"}],ids:[{required:!0,message:"权限ID不得为空",trigger:"blur"}],urls:[{required:!0,message:"权限地址不得为空",trigger:"blur"}]},btn:{}}},methods:{success:function(){this.getRoleLists(this.page,this.limit),this.syncVisible=!1},getRoleLists:function(e,t){var a=this,i={page:e,limit:t};N.RoleLists(i).then(function(e){e&&200===e.data.code&&(a.roleLists=e.data.item.role.data,a.total=e.data.item.role.total,a.authLists=e.data.item.auth,a.loading=!1)})},sizeChange:function(e){this.limit=e,this.getRoleLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getRoleLists(this.page,this.limit)},addRole:function(){this.title="添加角色",this.syncVisible=!0,this.url=this.cgi.insert,this.act="add",this.defaultChecked=[],this.roleModel={role_name:"",auth_ids:[],auth_url:[],status:"1",created_at:M.a.get_timestamp(),updated_at:M.a.get_timestamp()}},handleChange:function(e,t,a){var i=this;switch(t){case"left":a.forEach(function(e,t){i.ids.splice(i.ids.indexOf(e),1)});break;case"right":a.forEach(function(e,t){i.ids.push(parseInt(e))})}i.roleModel.auth_ids=i.ids},updateRole:function(e){for(var t in this.syncVisible=!0,this.title="修改角色",this.url=this.cgi.update,this.ids=JSON.parse(e.auth_ids),this.urls=JSON.parse(e.auth_url),this.defaultChecked=[],this.act="update",this.ids)this.defaultChecked.push(parseInt(this.ids[t]));this.roleModel=e,this.roleModel.auth_ids=this.defaultChecked}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getRoleLists(this.page,this.limit)})}},he={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[e.btn.add?a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addRole}},[e._v("添 加")])],1)],1):e._e(),e._v(" "),a("el-table",{attrs:{data:e.roleLists.filter(function(t){return!e.search||t.role_name.includes(e.search)})}},[a("el-table-column",{attrs:{label:"#",prop:"id",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"角色名称",prop:"role_name"}}),e._v(" "),e.btn.edit?a("el-table-column",{attrs:{label:"显示状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Radio",{attrs:{item:t.row,url:e.cgi.status}})]}}],null,!1,2058033001)}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",sortable:"",prop:"created_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",sortable:"",prop:"updated_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateRole(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.roleLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.roleModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.roleModel.role_name,callback:function(t){e.$set(e.roleModel,"role_name",t)},expression:"roleModel.role_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限列表",prop:"auth_ids"}},[a("el-transfer",{attrs:{titles:["所有","拥有"],"button-texts":["移除","添加"],data:e.authLists,filterable:""},on:{change:e.handleChange},model:{value:e.defaultChecked,callback:function(t){e.defaultChecked=t},expression:"defaultChecked"}})],1),e._v(" "),"add"===e.act?a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.roleModel.status,callback:function(t){e.$set(e.roleModel,"status",t)},expression:"roleModel.status"}},[a("el-radio-button",{attrs:{label:"0"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.roleModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var fe=a("VU/8")(pe,he,!1,function(e){a("xcmO")},"data-v-23277e52",null).exports,ge={name:"Upload",props:{avatar_url:{type:String,default:function(){return""}},username:{type:String,default:function(){return""}},size:{type:[Number,String],default:function(){return 100}},index:{type:[Number,String],default:function(){return 1}}},data:function(){return{fileData:{},headers:{},uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload.replace("/","")}},methods:{uploadSuccess:function(e){if(e&&200===e.code)return this.$message({type:"success",message:e.msg}),void this.$emit("uploadSuccess",e.item.src);this.$message({type:"warning",message:e.msg})},beforeUpload:function(e){var t=e.type;return["image/jpg","image/gif","image/png","image/jpeg"].includes(t)?!(e.size>2097152)||(this.$message({type:"warning",message:"upload image size error"}),!1):(this.$message({type:"warning",message:"upload image format error"}),!1)}},created:function(){this.fileData.token=this.$store.state.login.token,this.fileData.rand=!0,this.headers.Authorization=""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+this.fileData.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12))}},ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{attrs:{action:e.uploadUrl,data:e.fileData,headers:e.headers,"show-file-list":!1,index:e.index,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload}},[a("el-avatar",{attrs:{src:e.avatar_url,alt:e.username,fit:"cover",size:e.size}})],1)},staticRenderFns:[]};var be=a("VU/8")(ge,ve,!1,function(e){a("kV/C")},"data-v-1a5e7e1e",null).exports,_e={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe,Upload:be},data:function(){return{userLists:[],roleLists:[],page:1,limit:15,total:0,search:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"user",act:"",userModel:{},cgi:{insert:g.userSave,update:g.userUpdate,remove:g.userDelete,status:g.userUpdate},rules:{username:[{required:!0,message:"管理员名称不得为空",trigger:"blur"}],password:[{required:!0,message:"密码不得为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不得为空",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],phone_number:[{required:!0,message:"手机号不得为空",trigger:"blur"}],role_id:[{required:!0,message:"角色不得为空",trigger:"change"}]},btn:{}}},computed:m()({},Object(p.c)(["username","role_id"])),methods:{success:function(){this.getUserLists(this.page,this.limit),this.syncVisible=!1},uploadSuccess:function(e){this.userModel.avatar_url=e},getUserLists:function(e,t){var a=this,i={page:e,limit:t,level:"1"};N.UserLists(i).then(function(e){e&&200===e.data.code&&(a.userLists=e.data.item.data,a.total=e.data.item.total,a.roleLists=e.data.item.roleLists,a.loading=!1)})},sizeChange:function(e){this.limit=e,this.getUserLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getUserLists(this.page,this.limit)},addUser:function(){this.title="添加管理员",this.syncVisible=!0,this.act="add",this.userModel={username:"",email:"",password:"",salt:M.a.set_random(),status:"1",role_id:1,phone_number:"",created_at:M.a.get_timestamp(),updated_at:M.a.get_timestamp(),remember_token:""},this.url=this.cgi.insert},updateUser:function(e){this.title="修改管理员",this.syncVisible=!0,this.userModel=e,this.url=this.cgi.update,this.act="update"}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getUserLists(this.page,this.limit)})}},ye={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[e.btn.add&&e.role_id===e.md5("1")?a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addUser}},[e._v("添 加")])],1)],1):e._e(),e._v(" "),a("el-table",{attrs:{data:e.userLists.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())||t.email.toLowerCase().includes(e.search.toLowerCase())||t.phone_number.toLowerCase().includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"#",prop:"id"}}),e._v(" "),a("el-table-column",{attrs:{label:"管理员",prop:"username"}}),e._v(" "),a("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.avatar_url,fit:"cover",title:e.row.username,"preview-src-list":[e.row.avatar_url]}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"邮箱",prop:"email","show-tooltip-when-overflow":""}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",prop:"phone_number"}}),e._v(" "),e.role_id===e.md5("1")?a("el-table-column",{attrs:{label:"允许登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Radio",{attrs:{item:t.row,url:e.cgi.status}})]}}],null,!1,2058033001)}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"created_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",prop:"updated_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"right",width:"200px"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateUser(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.userLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.userModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"管理员",prop:"username"}},[a("el-input",{attrs:{placeholder:"管理员名称"},model:{value:e.userModel.username,callback:function(t){e.$set(e.userModel,"username",t)},expression:"userModel.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像",prop:"avatar_url"}},[a("Upload",{attrs:{avatar_url:e.userModel.avatar_url,username:e.userModel.username},on:{uploadSuccess:e.uploadSuccess}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.userModel.password,callback:function(t){e.$set(e.userModel,"password",t)},expression:"userModel.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"邮箱"},model:{value:e.userModel.email,callback:function(t){e.$set(e.userModel,"email",t)},expression:"userModel.email"}})],1),e._v(" "),"update"===e.act?a("el-form-item",{attrs:{label:"手机号",prop:"phone_number"}},[a("el-input",{attrs:{type:"email",placeholder:"手机号"},model:{value:e.userModel.phone_number,callback:function(t){e.$set(e.userModel,"phone_number",t)},expression:"userModel.phone_number"}})],1):e._e(),e._v(" "),e.role_id===e.md5("1")?a("el-form-item",{attrs:{label:"角色",prop:"role_id"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.userModel.role_id,callback:function(t){e.$set(e.userModel,"role_id",t)},expression:"userModel.role_id"}},e._l(e.roleLists,function(e,t){return a("el-option",{key:t,attrs:{label:e.role_name,value:e.id}})}),1)],1):e._e(),e._v(" "),"add"===e.act?a("el-form-item",{attrs:{label:"显示状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.userModel.status,callback:function(t){e.$set(e.userModel,"status",t)},expression:"userModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.userModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var xe=a("VU/8")(_e,ye,!1,function(e){a("O0WG")},"data-v-5a128690",null).exports,ke={name:"lists",components:{Submit:ie,Upload:be},data:function(){return{loading:!0,loadingText:"玩命加载中。。。",userCenter:{u_name:"",local:[],ip_address:[],notice_status:"",user_status:"",desc:"",tags:[],u_type:""},reFrom:"center",refs:this.$refs,url:g.saveUserCenter,fileData:{},headers:{},cgi:{save:""},rules:{avatarUrl:[{required:!0,message:"用户头像不得为空",trigger:"change"}],u_name:[{required:!0,message:"用户名称不得为空",trigger:"blur"}],u_type:[{required:!0,message:"账户类型不得为空",trigger:"blur"}],local:[{required:!0,message:"居住地址不得为空",trigger:"change"}],ip_address:[{required:!0,message:"用户地址不得为空",trigger:"change"}],desc:[{required:!0,message:"个人介绍不得为空",trigger:"blur"}],tags:[{required:!0,message:"用户标签不得为空",trigger:"blur"}],notice_status:[{required:!0,message:"站内通知",trigger:"change"}],user_status:[{required:!0,message:"账号信息",trigger:"change"}]},inputVisible:!1,inputValue:"",pid:1,options:[],props:{value:"name",label:"name"}}},computed:m()({},Object(p.c)(["username","avatarUrl"])),methods:{handleClose:function(e){this.userCenter.tags.splice(this.userCenter.tags.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.focus()})},setLocal:function(e){return e.length>0?e.join(",").replace(new RegExp(/,/g)," / "):e},handleInputConfirm:function(){var e=this.inputValue;if(e&&this.userCenter.tags.indexOf(e)<0){if(this.userCenter.tags.length+1>4)return void this.$message.warning("User tags must not exceed four");this.userCenter.tags.push(e)}this.inputVisible=!1,this.inputValue=""},getCity:function(e){var t=this;N.AreaLists({parent_id:e},g.areaLists).then(function(e){e&&200===e.data.code&&t.setOptions(e.data.item)})},setOptions:function(e){for(var t in e)0===e[t].children.length&&delete e[t].children,this.setOptions(e[t].children);this.options=e},getUserCenter:function(){var e=this;this.loading=!0,N.UserCenter([]).then(function(t){t&&200===t.data.code&&(e.loading=!1,e.userCenter=t.data.item,e.userCenter.user_status=e.userCenter.user_status.toString(),e.userCenter.notice_status=e.userCenter.notice_status.toString(),e.getCity(e.pid))})},resetForm:function(e){this.$refs[e].resetFields()}},mounted:function(){this.$nextTick(function(){this.getUserCenter()})}},we={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{xl:6,lg:6}},[a("el-card",{attrs:{shadow:"always"}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-avatar",{attrs:{src:e.avatarUrl,size:100,alt:e.username}})],1),e._v(" "),a("div",{staticClass:"message"},[a("p",[a("i",{staticClass:"el-icon-user"}),e._v(" "+e._s(e.userCenter.u_name))]),e._v(" "),a("p",[a("i",{staticClass:"el-icon-message"}),e._v(" "+e._s(e.userCenter.email))]),e._v(" "),a("p",[a("i",{staticClass:"el-icon-location-information"}),e._v(" "+e._s(e.setLocal(e.userCenter.local)))]),e._v(" "),a("p",[a("i",{staticClass:"el-icon-aim"}),e._v(" "+e._s(e.userCenter.desc))]),e._v(" "),a("p",[a("i",{staticClass:"el-icon-collection-tag"}),e._v(" "),e._l(e.userCenter.tags,function(t){return a("el-button",{key:t,staticStyle:{"margin-bottom":"5px"},attrs:{size:"mini",plain:"",type:"primary"}},[e._v(e._s(t))])})],2),e._v(" "),a("p",[a("i",{class:"1"===e.userCenter.notice_status?"el-icon-microphone":"el-icon-turn-off-microphone"}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"1"===e.userCenter.notice_status?"primary":"info",plain:""}},[e._v(e._s("1"===e.userCenter.notice_status?"启用站内通知":"禁用站内通知"))])],1),e._v(" "),a("p",[a("i",{class:"1"===e.userCenter.user_status?"el-icon-microphone":"el-icon-turn-off-microphone"}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"1"===e.userCenter.user_status?"primary":"info",plain:""}},[e._v(e._s("1"===e.userCenter.user_status?"启用账号通知":"禁用账号通知"))])],1)])])],1),e._v(" "),a("el-col",{attrs:{xl:18,lg:18}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"基础设置"}}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("el-form",{ref:"center",attrs:{model:e.userCenter,"label-width":"80px","label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"头像"}},[a("el-avatar",{attrs:{src:e.avatarUrl,size:100,alt:e.username}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"u_name"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.userCenter.u_name,callback:function(t){e.$set(e.userCenter,"u_name",t)},expression:"userCenter.u_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"居住地址",prop:"local"}},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{props:e.props,options:e.options,filterable:""},model:{value:e.userCenter.local,callback:function(t){e.$set(e.userCenter,"local",t)},expression:"userCenter.local"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在地",prop:"ip_address"}},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{props:e.props,options:e.options,filterable:""},model:{value:e.userCenter.ip_address,callback:function(t){e.$set(e.userCenter,"ip_address",t)},expression:"userCenter.ip_address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"座右铭",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:"3","show-word-limit":"",maxlength:"32",placeholder:"这个人很懒，什么也没有留下"},model:{value:e.userCenter.desc,callback:function(t){e.$set(e.userCenter,"desc",t)},expression:"userCenter.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"个人标签",prop:"tags"}},[e._l(e.userCenter.tags,function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n                                "+e._s(t)+"\n                            ")])}),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticStyle:{width:"100px"},attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ New Tag")])],2),e._v(" "),a("el-form-item",{attrs:{label:"站内通知",prop:"notice_status"}},[a("el-tooltip",{attrs:{effect:"dark",content:"系统性的通知或者更新消息",placement:"top-start"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"2"},model:{value:e.userCenter.notice_status,callback:function(t){e.$set(e.userCenter,"notice_status",t)},expression:"userCenter.notice_status"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"账号信息",prop:"user_status"}},[a("el-tooltip",{attrs:{effect:"dark",content:"帐号变更的通知消息",placement:"top-start"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"2"},model:{value:e.userCenter.user_status,callback:function(t){e.$set(e.userCenter,"user_status",t)},expression:"userCenter.user_status"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("Submit",{attrs:{reFrom:e.reFrom,url:e.url,model:e.userCenter,refs:e.refs}})],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ce=a("VU/8")(ke,we,!1,function(e){a("IQy7")},"data-v-a8ebff44",null).exports,Le={name:"lists",components:{Submit:ie,Upload:be},data:function(){return{labelWidth:"80px",loading:!1,loadingText:"玩命加载中。。。",url:g.userSave,refs:this.$refs,reFrom:"user",showPassword:!1,userModel:{username:"",email:"",password:"",salt:M.a.set_random(),status:1,role_id:2,phone_number:"",created_at:M.a.get_timestamp(),updated_at:M.a.get_timestamp(),avatar_url:""},rules:{username:[{required:!0,message:"登陆账号不得为空",trigger:"blur"}],password:[{required:!0,message:"密码不得为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不得为空",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],status:[{required:!0,message:"用户状态不得为空",trigger:"change"}],avatar_url:[{required:!0,message:"用户头像不得为空",trigger:"change"}]}}},computed:m()({},Object(p.c)(["username","token","avatarUrl"])),methods:{userBind:function(){var e=this;N.UserBind({remember_token:this.token}).then(function(t){t&&200===t.data.code&&(e.userModel=t.data.item)})},uploadSuccess:function(e){this.userModel.avatar_url=e},success:function(){}},mounted:function(){this.$nextTick(function(){this.userBind()})},created:function(){this.userModel.username=this.username,this.userModel.avatar_url=this.avatarUrl,this.userModel.remember_token=this.token,console.log(this.userModel)}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.userModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名称",prop:"username"}},[a("el-input",{attrs:{placeholder:"管理员名称"},model:{value:e.userModel.username,callback:function(t){e.$set(e.userModel,"username","string"==typeof t?t.trim():t)},expression:"userModel.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像",prop:"avatar_url"}},[a("Upload",{attrs:{avatar_url:e.userModel.avatar_url,username:e.userModel.username},on:{uploadSuccess:e.uploadSuccess}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[a("el-input",{attrs:{type:e.showPassword?"":"password"},model:{value:e.userModel.password,callback:function(t){e.$set(e.userModel,"password",t)},expression:"userModel.password"}},[a("el-button",{attrs:{slot:"append",icon:e.showPassword?"el-icon-open":"el-icon-turn-off"},on:{click:function(t){e.showPassword=!e.showPassword}},slot:"append"},[e._v("\n                    "+e._s(e.showPassword?"显 示":"隐 藏")+"\n                ")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户邮箱",prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"邮箱（请填写正确的邮箱，便于后期密码修改，密码找回）"},model:{value:e.userModel.email,callback:function(t){e.$set(e.userModel,"email","string"==typeof t?t.trim():t)},expression:"userModel.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户手机",prop:"phone_number"}},[a("el-input",{attrs:{placeholder:"手机号（请填写正确的手机号，便于后期密码修改，密码找回）"},model:{value:e.userModel.phone_number,callback:function(t){e.$set(e.userModel,"phone_number",e._n(t))},expression:"userModel.phone_number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"显示状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.userModel.status,callback:function(t){e.$set(e.userModel,"status",t)},expression:"userModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.userModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var Me=a("VU/8")(Le,Se,!1,function(e){a("HXjg")},"data-v-2bd5c908",null).exports,$e={name:"log",components:{Delete:ce},data:function(){return{logLists:[],page:1,limit:15,total:0,search:"",loading:!0,loadingText:"玩命加载中。。。",cgi:{remove:g.logDelete},btn:{}}},methods:{success:function(){this.getLogLists(this.page,this.limit)},getLogLists:function(e,t){var a=this;N.LogLists({page:e,limit:t}).then(function(e){e&&200===e.data.code&&(a.logLists=e.data.item.data,a.total=e.data.item.total,a.loading=!1)})},sizeChange:function(e){this.limit=e,this.getLogLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getLogLists(this.page,this.limit)}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getLogLists(this.page,this.limit)})}},Te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-table",{attrs:{data:e.logLists.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())||t.ip_address.includes(e.search.toLowerCase())||t.log.includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"#",prop:"id",sortable:"",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"执行人",prop:"username",sortable:"",width:"150px"}}),e._v(" "),a("el-table-column",{attrs:{label:"日志信息","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"success",href:t.row.url,target:"_blank"}},[e._v("["+e._s(t.row.url)+"]")]),e._v("　"+e._s(t.row.log)+"　\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地址",prop:"ip_address",width:"200px"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",sortable:"",prop:"created_at",width:"200px"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"right",width:"200px"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键字查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.logLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},staticRenderFns:[]};var Oe=a("VU/8")($e,Te,!1,function(e){a("L/RK")},"data-v-44be5e5c",null).exports,Ve=a("gZhU");a("c6RA"),a("aGTD"),a("UM8r"),a("Yokd"),a("THjC"),a("Kk9m"),a("fo6W"),a("fo6W"),a("soCA"),a("vq+x");var Re={name:"lists",components:{codemirror:Ve.codemirror},data:function(){return{props:{label:"label",children:"children",isLeaf:!1},options:{mode:"text/x-php",tabSize:4,lineNumbers:!0,theme:"monokai",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!1,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,cursorHeight:1,autoRefresh:!0,styleActiveLine:!0,readOnly:!0,showCursorWhenSelecting:!0},highlight:!0,fileLists:[],path:"storage_path",loading:!0,loadingText:"玩命加载中。。。",filterText:"",fileModel:{content:"",path:""}}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:m()({},Object(p.c)(["currSystemLogObj","token"])),methods:m()({},Object(p.b)(["addCurrSystemLogObj"]),{filterNode:function(e,t){return!e||-1!==t.label.toLowerCase().indexOf(e.toLowerCase())},getFileLists:function(e){var t=this,a={path:e,basename:"/logs//"};N.FileLists(a).then(function(e){e&&200===e.data.code&&(t.fileLists=e.data.item,t.getFileContent(t.fileLists[t.fileLists.length-1]),t.loading=!1)})},getFileContent:function(e){var t=this,a={path:e.path};this.fileModel.name=e.label,N.FileRead(a).then(function(e){e&&200===e.data.code&&(t.fileModel.content=e.data.item.content,t.addCurrSystemLogObj(t.fileModel))})}}),mounted:function(){this.$nextTick(function(){this.getFileLists(this.path)})}},De={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xl:{span:5},lg:{span:5},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"background-color":"#393d49"},attrs:{data:e.fileLists,"highlight-current":e.highlight,props:e.props,"filter-node-method":e.filterNode,"node-key":e.props.id},on:{"node-click":e.getFileContent}})],1),e._v(" "),a("el-col",{attrs:{xl:{span:18,push:1},lg:{span:18,push:1},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-form",{attrs:{model:e.fileModel}},[a("el-form-item",{staticStyle:{"margin-left":"-30px !important"}},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.fileModel.name,callback:function(t){e.$set(e.fileModel,"name",t)},expression:"fileModel.name"}},[a("el-tab-pane",{key:e.fileModel.name,attrs:{label:e.fileModel.name,name:e.fileModel.name}}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("codemirror",{staticStyle:{"line-height":"20px"},attrs:{value:e.fileModel.content,options:e.options}})],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var Fe=a("VU/8")(Re,De,!1,function(e){a("YFzo")},"data-v-a624e6ba",null).exports;a("c6RA"),a("f6fj"),a("ezqs"),a("Mixr"),a("5IAE"),a("aGTD"),a("UM8r"),a("Yokd"),a("THjC"),a("Kk9m"),a("fo6W"),a("fo6W"),a("soCA"),a("vq+x");var Ue={name:"lists",components:{Submit:ie,codemirror:Ve.codemirror},data:function(){return{props:{label:"label",children:"children",isLeaf:!1},checkBoxArr:[{id:4,value:"读取"},{id:2,value:"写入"},{id:1,value:"执行"}],all:[],user:[],common:[],all_id:0,user_id:0,common_id:0,chmodModel:{auth:parseInt(this.all_id+""+this.user_id+this.common_id),path:""},compressionModel:{docLists:[],resource:"",path:""},mode:{markdown:"text/markdown",php:"text/x-php",xml:"text/xml",json:"application/ld+json"},options:{mode:"text/x-php",tabSize:4,lineNumbers:!0,theme:"monokai",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!1,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,cursorHeight:1,autoRefresh:!0,styleActiveLine:!0,readOnly:!0},menuVisible:!1,highlight:!0,fileLists:[],path:"base_path",activeFileTabName:null,title:"default",syncVisible:!1,modal:!0,labelWidth:"80px",center:!0,loading:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"file",fileObject:{},showRightBtn:{add:!0,rename:!0,remove:!0,compression:!0,DeCompression:!1,auth:!0,download:!0,upload:!0},fileModel:{content:"",path:""},fileList:[],fileSyncVisible:!1,fileData:{},headers:{},showIdea:!0,cgi:{update:g.fileUpdate,chmod:g.fileChmod,uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload.replace("/","")},imgVisible:!1,dialogImageUrl:"",dialogImageName:"",rules:{auth:[{required:!0,message:"权限不得为空",trigger:"blur"},{type:"number",message:"权限必须为数字值",trigger:"blur"}]},filterText:"",scrollTop:0,btn:{}}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:m()({},Object(p.c)(["fileTabs","currFileObj","token","username"])),methods:m()({},Object(p.b)(["addFileTabs","deleteFileTabs","addCurrFileObj","saveSystemLog"]),{success:function(){this.addCurrFileObj(this.fileModel),this.getFileLists(this.path),this.syncVisible=!1},filterNode:function(e,t){return!e||-1!==t.label.toLowerCase().indexOf(e.toLowerCase())},getFileLists:function(e){var t=this,a={path:e,basename:"/"};N.FileLists(a).then(function(e){e&&200===e.data.code&&(t.fileLists=e.data.item,t.loading=!1)})},rightClick:function(e,t,a,i){this.menuVisible=!1,this.menuVisible=!0;var s=document.querySelector("#menu");switch(this.scrollTop=M.a.get_scroll_top(),document.addEventListener("click",this.foo),s.style.left="360px",s.style.top=e.clientY+this.scrollTop-135+"px",this.fileObject=t,this.fileObject.fileType){case"file":this.showRightBtn.DeCompression=!1,this.showRightBtn.download=!0;var n=this.fileObject.label.split(".")[1];["tar","zip","7z","TAR","ZIP","7Z"].includes(n)&&(this.showRightBtn.DeCompression=!0);break;case"dir":this.showRightBtn.download=!1,this.showRightBtn.DeCompression=!1}},foo:function(){this.menuVisible=!1,document.removeEventListener("click",this.foo)},goto:function(e){var t=e.label.split(".")[1];this.setOptionsMode(t);var a=this.fileTabs;for(var i in a)if(a[i].label===e.label){this.fileModel.content=a[i].content,this.fileModel.path=a[i].path;var s={content:this.fileModel.content,path:this.fileModel.path,name:a[i].name};this.addCurrFileObj(s)}},removeTabName:function(e){var t=this;this.fileTabs.forEach(function(a,i){if(a.name===e){var s=t.fileTabs[i+1]||t.fileTabs[i-1];if(s){t.activeFileTabName=s.name,t.fileModel.content=s.content;var n={content:s.content,path:s.path,name:s.name};t.addCurrFileObj(n),t.deleteFileTabs(e)}}})},getFileContent:function(e){var t=this,a=e.label.split(".")[1];if(["tar","zip","7z","TAR","ZIP","7Z"].includes(a)||"file"!==e.fileType)return!1;if(["png","jpg","jpeg","gif","PNG","JPG","JPEG","GIF"].includes(a))return this.dialogImageName=e.label,void N.ImagePreview({path:e.path}).then(function(e){e&&200===e.data.code&&(t.dialogImageUrl=e.data.item.src,t.imgVisible=!0)});this.setOptionsMode(a),this.showIdea=!0,this.activeFileTabName=e.size.toString();var i={path:e.path},s={};this.url=this.cgi.update,s.label=e.label,s.name=e.size.toString(),s.path=e.path,N.FileRead(i).then(function(a){a&&200===a.data.code&&(t.fileModel.content=a.data.item.content,t.fileModel.path=e.path,s.content=t.fileModel.content,t.addCurrFileObj(s),t.addFileTabs(s))})},setOptionsMode:function(e){switch(e){case"xml":this.options.mode=this.mode.xml;break;case"md":this.options.mode=this.mode.markdown;break;case"json":case"lock":this.options.mode=this.mode.json;break;default:this.options.mode=this.mode.php}},renameFile:function(){var e=this,t={oldFile:this.fileObject.path};console.log(this.fileObject),this.$prompt("请输入新的文件名","["+this.fileObject.label+"] 重命名",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var i=a.value;if(""===i||null===i||"null"===i||"undefined"===i)return e.$message.warning("File name cannot be empty"),!1;t.newFile=t.oldFile.replace(e.fileObject.label,i),N.FileRename(t).then(function(t){if(t&&200===t.data.code){e.fileObject.name=i,e.$message({type:"success",message:t.data.msg+"："+i});var a={href:g.fileSave,msg:t.data.msg+"："+i};e.saveSystemLog(a),e.getFileLists(e.path)}})}).catch(function(){e.$message({type:"info",message:"cancel entry"})})},deleteFile:function(){var e=this;this.$confirm("此操作将永远删除该条记录，是否继续？","删除记录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={path:e.fileObject.path};N.FileDelete(t).then(function(a){if(a&&200===a.data.code){var i={msg:a.data.msg+"："+t.path,href:g.fileDelete};e.saveSystemLog(i),e.getFileLists(e.path),e.$message({type:"success",message:a.data.msg+"："+t.path})}})}).catch(function(){e.$message({type:"info",message:"cancel remove！"})})},addFile:function(){var e=this,t={};this.$prompt("请输入文件名","新建文件",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var i=a.value;if(""===i||null===i||"null"===i||"undefined"===i)return e.$message.warning("File name cannot be empty"),!1;"file"===e.fileObject.fileType?t.path=e.fileObject.path.replace(e.fileObject.label,i):"dir"===e.fileObject.fileType&&(t.path=e.fileObject.path+"/"+i),N.FileSave(t).then(function(a){if(a&&200===a.data.code){var i={msg:a.data.msg+"："+t.path,href:g.fileRename};e.saveSystemLog(i),e.getFileLists(e.path),e.$message({type:"success",message:a.data.msg+"："+t.path})}})}).catch(function(){e.$message({type:"info",message:"cancel entry"})})},authFile:function(){this.syncVisible=!0,this.title="设置权限【"+this.fileObject.path+"】",this.chmodModel.auth=parseInt(this.fileObject.auth),this.chmodModel.path=this.fileObject.path,this.all_id=this.fileObject.auth.substr(0,1),this.user_id=this.fileObject.auth.substr(1,1),this.common_id=this.fileObject.auth.substr(2,1),this.all=this.setChmod(this.all_id),this.user=this.setChmod(this.user_id),this.common=this.setChmod(this.common_id),this.url=this.cgi.chmod},setChmod:function(e){var t=[];switch(e){case"7":t=["读取","写入","执行"];break;case"6":t=["读取","写入"];break;case"5":t=["读取","执行"];break;case"4":t=["读取"];break;case"3":t=["写入","执行"];break;case"2":t=["写入"];break;case"1":t=["执行"]}return t},setChmodAuth:function(){this.chmodModel.auth=parseInt(this.chmodModel.auth),this.chmodModel.auth>666&&(this.$message({type:"warning",message:"Permission setting failed"}),this.chmodModel.auth=parseInt(this.fileObject.auth)),this.all_id=this.chmodModel.auth.toString().substr(0,1),this.user_id=this.chmodModel.auth.toString().substr(1,1),this.common_id=this.chmodModel.auth.toString().substr(2,1),this.all=this.setChmod(this.all_id),this.user=this.setChmod(this.user_id),this.common=this.setChmod(this.common_id),this.url=this.cgi.chmod},getChmod:function(e){var t=0;for(var a in e)"读取"===e[a]&&(t+=4),"写入"===e[a]&&(t+=2),"执行"===e[a]&&(t+=1);return t},allChange:function(e){this.all_id=this.getChmod(e),this.chmodModel.auth=parseInt(this.all_id+""+this.user_id+this.common_id)},userChange:function(e){this.user_id=this.getChmod(e),this.chmodModel.auth=parseInt(this.all_id+""+this.user_id+this.common_id)},commonChange:function(e){this.common_id=this.getChmod(e),this.chmodModel.auth=parseInt(this.all_id+""+this.user_id+this.common_id)},compressionFile:function(){var e=this;this.$prompt("请输入文件名","压缩包名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value;if(""===a||null===a||"null"===a||"undefined"===a)return e.$message.warning("Archive name must not be empty"),!1;e.compressionModel.resource=a.indexOf(".")>=0?a.split(".")[0]:a,e.compressionModel.docLists.push(e.fileObject.path),e.compressionModel.path=e.fileObject.path.replace(e.fileObject.label,""),N.Compression(e.compressionModel).then(function(t){if(t&&200===t.data.code){e.$message({type:"success",message:t.data.msg});var a={msg:t.data.msg+"："+e.fileObject.label,href:g.fileCompression};e.saveSystemLog(a),e.getFileLists(e.path)}})}).catch(function(){e.$message({type:"info",message:"cancel entry"})})},DecompressionFile:function(){var e=this;this.$prompt("请输入文件名","解压包名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value;if(""===a||null===a||"null"===a||"undefined"===a)return e.$message.warning("Extract package name must not be empty"),!1;var i={path:e.fileObject.path,resource:a.indexOf(".")>=0?a.split(".")[0]:a};N.Decompression(i).then(function(t){if(t&&200===t.data.code){e.$message({type:"success",message:t.data.msg});var a={msg:t.data.msg,href:g.fileDecompression};e.saveSystemLog(a),e.getFileLists(e.path)}})}).catch(function(){e.$message({type:"info",message:"cancel input"})})},downloadFile:function(){var e=this;this.$alert("确定下载文件："+this.fileObject.path,"文件下载").then(function(){window.open("https://www.fanglonger.com/api/"+g.fileDownload.replace("/","")+"?token="+e.token+"&path="+e.fileObject.path,"__target");var t={msg:"file download successfully："+e.fileObject.path,href:g.fileDownload};e.saveSystemLog(t),e.$message({type:"success",message:"download file successfully"})}).catch(function(){e.$message({type:"info",message:"cancel download"})})},uploadFile:function(){this.fileSyncVisible=!0,this.fileData.token=this.token,"file"===this.fileObject.fileType?this.fileData.path=this.fileObject.path.replace(this.fileObject.label,""):"dir"===this.fileObject.fileType&&(this.fileData.path=this.fileObject.path)},submitUpload:function(){this.headers.Authorization=""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+this.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12)),this.$refs.upload.submit()},handleRemove:function(e){this.$message({type:"warning",message:"cancel file upload："+e.name})},handelSuccess:function(e){if(200===e.code){this.$message({type:"success",message:e.msg});var t={msg:e.msg,result:e,href:g.fileUpload};this.saveSystemLog(t),this.getFileLists(this.path),this.fileSyncVisible=!1}},imagePreview:function(){var e=this,t=this.fileObject.name.split(".")[1];["png","jpeg","gif","jpg"].includes(t.toLowerCase())&&(this.imgVisible=!0,N.ImagePreview({name:response.item.name}).then(function(t){t&&200===t.data.code&&(e.dialogImageUrl=t.data.item.src)}))},updateContent:function(e){this.fileModel.content=e}}),created:function(){this.activeFileTabName=this.currFileObj.name,this.fileModel=this.currFileObj,null===this.activeFileTabName&&(this.fileModel.content="",this.showIdea=!1),"admin"===this.username&&(this.options.readOnly=!1)},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.url=this.cgi.update,this.getFileLists(this.path)})}},ze={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xl:{span:5},lg:{span:5},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"background-color":"#393d49"},attrs:{data:e.fileLists,"highlight-current":e.highlight,props:e.props,"filter-node-method":e.filterNode,"node-key":e.props.id},on:{"node-contextmenu":e.rightClick,"node-click":e.getFileContent}})],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.showIdea,expression:"showIdea"}],attrs:{xl:{span:18,push:1},lg:{span:18,push:1},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-form",{ref:e.reFrom,attrs:{model:e.fileModel}},[a("el-form-item",{staticStyle:{"margin-left":"-30px !important"}},[a("el-tabs",{staticStyle:{"text-align":"left!important"},attrs:{type:"border-card",closable:""},on:{"tab-click":e.goto,"tab-remove":e.removeTabName},model:{value:e.activeFileTabName,callback:function(t){e.activeFileTabName=t},expression:"activeFileTabName"}},[e._l(e.fileTabs,function(e){return a("el-tab-pane",{key:e.name,attrs:{label:e.label,name:e.name}})}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("codemirror",{ref:"edit",staticStyle:{"line-height":"20px"},attrs:{value:e.fileModel.content,options:e.options},on:{change:e.updateContent}})],1)],2)],1)],1),e._v(" "),e.btn.edit?a("Submit",{staticStyle:{"text-align":"center !important"},attrs:{reFrom:e.reFrom,model:e.fileModel,url:e.url,refs:e.refs},on:{success:e.success}}):e._e()],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],staticStyle:{"z-index":"100"}},[a("el-menu",{staticClass:"menu",staticStyle:{"border-bottom":"solid 1px #393d49"},attrs:{id:"menu",mode:"horizontal","background-color":"#393d49","text-color":"#cccccc","active-text-color":"#ffd04b"}},[a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.add&&e.btn.add,expression:"showRightBtn.add && btn.add"}],on:{click:e.addFile}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添 加")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.rename&&e.btn.rename,expression:"showRightBtn.rename && btn.rename"}],on:{click:e.renameFile}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v("重命名")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.auth&&e.btn.chmod,expression:"showRightBtn.auth && btn.chmod"}],on:{click:e.authFile}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("权 限")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.compression&&e.btn.gzip,expression:"showRightBtn.compression && btn.gzip"}],on:{click:e.compressionFile}},[a("i",{staticClass:"el-icon-collection"}),e._v("压 缩")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.DeCompression&&e.btn.unzip,expression:"showRightBtn.DeCompression && btn.unzip"}],on:{click:e.DecompressionFile}},[a("i",{staticClass:"el-icon-receiving"}),e._v("解 压")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.download&&e.btn.download,expression:"showRightBtn.download && btn.download"}],on:{click:e.downloadFile}},[a("i",{staticClass:"el-icon-download"}),e._v("下 载")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.upload&&e.btn.upload,expression:"showRightBtn.upload && btn.upload"}],on:{click:e.uploadFile}},[a("i",{staticClass:"el-icon-upload"}),e._v("上 传")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.showRightBtn.remove&&e.btn.del,expression:"showRightBtn.remove && btn.del"}],on:{click:e.deleteFile}},[a("i",{staticClass:"el-icon-delete-solid"}),e._v("删 除")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.syncVisible,modal:e.modal,title:e.title,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.chmodModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"权限",prop:"auth",required:""}},[a("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.setChmodAuth},model:{value:e.chmodModel.auth,callback:function(t){e.$set(e.chmodModel,"auth",t)},expression:"chmodModel.auth"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所有者",required:""}},[a("el-checkbox-group",{on:{change:e.allChange},model:{value:e.all,callback:function(t){e.all=t},expression:"all"}},e._l(e.checkBoxArr,function(e){return a("el-checkbox",{key:e.id,attrs:{border:"",size:"small",label:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户组",required:""}},[a("el-checkbox-group",{on:{change:e.userChange},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}},e._l(e.checkBoxArr,function(e){return a("el-checkbox",{key:e.id,attrs:{border:"",size:"small",label:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"公共",required:""}},[a("el-checkbox-group",{on:{change:e.commonChange},model:{value:e.common,callback:function(t){e.common=t},expression:"common"}},e._l(e.checkBoxArr,function(e){return a("el-checkbox",{key:e.id,attrs:{border:"",size:"small",label:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.chmodModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.fileSyncVisible,modal:e.modal,title:"文件上传",center:e.center},on:{"update:visible":function(t){e.fileSyncVisible=t}}},[a("el-button",{staticStyle:{"margin-left":"10px","margin-bottom":"20px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),e._v(" "),a("el-upload",{ref:"upload",attrs:{data:e.fileData,action:e.cgi.uploadUrl,headers:e.headers,"on-remove":e.handleRemove,"on-success":e.handelSuccess,"file-list":e.fileList,"auto-upload":!1,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"trigger"},slot:"trigger"})])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.imgVisible,width:"30%",title:e.dialogImageName,center:""},on:{"update:visible":function(t){e.imgVisible=t}}},[a("el-image",{attrs:{src:e.dialogImageUrl,alt:e.dialogImageName}})],1)],1)},staticRenderFns:[]};var Ne=a("VU/8")(Ue,ze,!1,function(e){a("zJyO")},"data-v-06d46e75",null).exports;a("Mixr"),a("5IAE"),a("aGTD"),a("UM8r"),a("Yokd"),a("THjC"),a("Kk9m"),a("fo6W"),a("fo6W"),a("soCA"),a("vq+x");var Ae={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe,codemirror:Ve.codemirror},data:function(){return{configLists:[],page:1,limit:15,total:0,title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"config",configValModel:{},configModel:{},configVal:{},cgi:{remove:g.configDelete,status:g.configUpdate,insert:g.configSave,update:g.configUpdate,updateVal:g.configValUpdate},rules:{name:[{required:!0,message:"配置名称不得为空",trigger:"blur"}]},show:!1,showBtn:!0,syncConfigVisible:!1,options:{mode:"application/ld+json",tabSize:4,lineNumbers:!0,theme:"monokai",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,cursorHeight:1,autoRefresh:!0,styleActiveLine:!0}}},methods:m()({},Object(p.b)(["saveSystemLog"]),{success:function(){this.syncVisible=!1,this.syncConfigVisible=!1,this.getConfigLists(this.page,this.limit)},getConfigLists:function(e,t){var a=this,i={page:e,limit:t};N.ConfigLists(i).then(function(e){e&&200===e.data.code&&(a.configLists=e.data.item,a.total=e.data.item.length,a.loading=!1)})},sizeChange:function(e){this.limit=e,this.getConfigLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getConfigLists(this.page,this.limit)},updateConfig:function(e){this.title="修改配置",this.configModel=e,this.url=this.cgi.update,this.syncConfigVisible=!0},updateContent:function(e){this.configModel.value=e},addConfig:function(){this.title="添加配置",this.configValModel={name:"",status:1,value:"[]"},this.show=!1,this.showBtn=!0,this.syncVisible=!0,this.url=this.cgi.insert},setConfigVal:function(e){this.configVal={name:"",value:"",status:1,id:1},this.configValModel=e,this.configVal.status=this.configValModel.status,this.configValModel.value=this.configVal,this.title="设置【"+e.name+"】配置值",this.show=!0,this.showBtn=!0,this.syncVisible=!0,this.url=this.cgi.update},getConfigVal:function(e){this.title="查看配置值",this.configValModel=e,this.configVal.name=e.name,this.configVal.value=e.value,this.show=!0,this.showBtn=!1,this.syncVisible=!0},removeConfigVal:function(e){var t=this;this.$confirm("此操作将永远删除该条记录，是否继续？","删除记录",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.act="remove",N.ConfigValUpdate(e).then(function(e){if(e&&200===e.data.code){t.getConfigLists(t.page,t.limit);var a={url:t.cgi.updateVal,msg:e.data.msg,token:t.$store.state.login.token};return t.saveSystemLog(a),t.$message({type:"success",message:e.data.msg}),!1}})}).catch(function(){t.$message({type:"info",message:"已取消删除！"})})}}),mounted:function(){this.$nextTick(function(){this.getConfigLists(this.page,this.limit)})}},qe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addConfig}},[e._v("添 加")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.configLists,"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{label:"#",prop:"id",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"配置名称",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"显示状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.children?a("div",[a("Radio",{attrs:{item:t.row,url:e.cgi.status},on:{success:e.success}})],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"created_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",prop:"updated_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.children?a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:function(a){return e.setConfigVal(t.row)}}},[e._v("添 加")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateConfig(t.row)}}},[e._v("修 改")])],1):a("div",[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-search",size:"mini"},on:{click:function(a){return e.getConfigVal(t.row)}}},[e._v("查 看")]),e._v(" "),a("el-button",{attrs:{plain:"",type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.removeConfigVal(t.row)}}},[e._v("删 除")])],1)]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.configValModel,rules:e.rules}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],attrs:{label:"配置名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"配置名称"},model:{value:e.configValModel.name,callback:function(t){e.$set(e.configValModel,"name",t)},expression:"configValModel.name"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{label:"配置健"}},[a("el-input",{attrs:{placeholder:"配置内容"},model:{value:e.configVal.name,callback:function(t){e.$set(e.configVal,"name",t)},expression:"configVal.name"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{label:"配置值"}},[a("el-input",{attrs:{placeholder:"配置内容"},model:{value:e.configVal.value,callback:function(t){e.$set(e.configVal,"value",t)},expression:"configVal.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配置状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.configValModel.status,callback:function(t){e.$set(e.configValModel,"status",t)},expression:"configValModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showBtn,expression:"showBtn"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.configValModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncConfigVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncConfigVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.configModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"配置名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"配置名称"},model:{value:e.configModel.name,callback:function(t){e.$set(e.configModel,"name",t)},expression:"configModel.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配置值",prop:"value"}},[a("codemirror",{ref:"edit",staticStyle:{"line-height":"20px"},attrs:{value:e.configModel.value,options:e.options},on:{change:e.updateContent}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配置状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.configModel.status,callback:function(t){e.$set(e.configModel,"status",t)},expression:"configModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("关闭")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.configModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var Ee=a("VU/8")(Ae,qe,!1,function(e){a("7zJS")},"data-v-73342cdf",null).exports,je=a("fZjL"),Be=a.n(je);a("Mixr"),a("5IAE"),a("aGTD"),a("UM8r"),a("Yokd"),a("THjC"),a("Kk9m"),a("fo6W"),a("fo6W"),a("soCA"),a("vq+x");var Ie={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe,codemirror:Ve.codemirror},data:function(){return{categoryLists:[],props:{label:"name",children:"children",id:"id"},filterText:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"category",apiName:"",menuVisible:!1,categoryModel:{},apiCategory:[],highlight:!0,options:{mode:"application/ld+json",tabSize:4,lineNumbers:!0,theme:"monokai",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!1,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],indentWithTabs:!0,smartIndent:!0,matchBrackets:!0,cursorHeight:1,autoRefresh:!0,styleActiveLine:!0},apiStatus:!1,methodLists:{POST:"POST",GET:"GET",PUT:"PUT",DELETE:"DELETE"},typeLists:{String:"String",Float:"Float",Number:"Number",Object:"Object",Array:"Array",Timestamp:"Timestamp"},cgi:{insert:g.apiSave,update:g.apiUpdate,categoryInsert:g.categorySave,categoryUpdate:g.categoryUpdate,remove:g.categoryDelete},rules:{type:[{required:!0,message:"请输入权限名称",trigger:"change"}],href:[{required:!0,message:"请输入权限地址",trigger:"blur"}],method:[{required:!0,message:"请输入请求方法",trigger:"change"}],desc:[{required:!0,message:"请输入接口描述",trigger:"blur"}],response_string:[{required:!0,message:"请输入返回参数",trigger:"blur"}]},scrollTop:0,btn:{}}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:m()({},Object(p.c)(["apiVisible","apiModel","interfaceName"])),methods:m()({},Object(p.b)(["addApiVisible","addApiModel","saveSystemLog"]),{success:function(){this.getCategoryLists(),this.syncVisible=!1},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},setName:function(e){return Array(e.level+1).join("　　")+e.name},getCategoryLists:function(){var e=this;N.CategoryLists().then(function(t){t&&200===t.data.code&&(e.apiCategory=t.data.item.category,e.categoryLists=t.data.item.category_tree,e.loading=!1)})},rightClick:function(e,t,a,i){this.menuVisible=!1,this.menuVisible=!0;var s=document.querySelector("#menu");this.scrollTop=M.a.get_scroll_top(),document.addEventListener("click",this.foo),s.style.left="290px",s.style.top=e.clientY+this.scrollTop-125+"px",this.categoryModel=t},foo:function(){this.menuVisible=!1,document.removeEventListener("click",this.foo)},addCategory:function(){this.title="添加接口",this.syncVisible=!0,this.url=this.cgi.categoryInsert,this.categoryModel={name:"",pid:void 0===this.categoryModel.id?"0":this.categoryModel.id,path:"1",level:1}},updateCategory:function(){this.title=this.categoryModel.name,this.syncVisible=!0,this.url=this.cgi.categoryUpdate},deleteCategory:function(){var e=this;N.CategoryDelete({id:this.categoryModel.id}).then(function(t){if(t&&200===t.data.code){var a={href:e.cgi.remove,msg:t.data.msg,token:e.$store.state.login.token};e.saveSystemLog(a),e.$message({type:"success",message:t.data.msg}),e.getCategoryLists()}})},getApiDetail:function(e){var t=this;if(e.level<=1)this.$notify({title:"通知",message:"该接口暂时不允许访问",type:"success"});else{var a={apiVisible:!0,interfaceName:e.name};this.addApiVisible(a),this.apiName=this.interfaceName,N.ApiLists({type:e.id}).then(function(a){if(a&&200===a.data.code)t.addApiModel(a.data.item),t.apiModel.request=JSON.parse(t.apiModel.request),t.apiModel.response=JSON.parse(t.apiModel.response),t.url=t.cgi.update;else{t.url=t.cgi.insert;var i={desc:"",type:e.id,href:"",method:"POST",request:[{name:"token",desc:"用户token",required:"1",type:"String",val:""}],response:[{name:"code",desc:"200 成功",type:"number"},{name:"msg",desc:"Success",type:"string"}],response_string:"",remark:""};t.addApiModel(i)}})}},requestRemove:function(e,t){var a=[],i=this;Be()(i.apiModel.request).forEach(function(e){a.push(i.apiModel.request[e])}),a.splice(t,1),i.apiModel.request=a},requestAdd:function(){this.apiModel.request.push({name:"",desc:"",required:"",type:"",val:""})},responseRemove:function(e,t){var a=[],i=this;Be()(i.apiModel.response).forEach(function(e){a.push(i.apiModel.response[e])}),a.splice(t,1),i.apiModel.response=a},responseAdd:function(){this.apiModel.response.push({name:"",desc:"",type:""})},updateContent:function(e){this.apiModel.response_string=e}}),created:function(){this.apiName=this.interfaceName,this.apiModel.id?this.url=this.cgi.update:this.url=this.cgi.insert},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getCategoryLists()})}},Pe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xl:{span:4},lg:{span:4},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:e.addCategory},slot:"append"})],1),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"background-color":"#393d49"},attrs:{props:e.props,"filter-node-method":e.filterNode,"highlight-current":e.highlight,data:e.categoryLists,"default-expand-all":"","node-key":e.props.id},on:{"node-contextmenu":e.rightClick,"node-click":e.getApiDetail}})],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.apiVisible,expression:"apiVisible"}],attrs:{xl:{span:19,push:1},lg:{span:19,push:1},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.apiName,callback:function(t){e.apiName=t},expression:"apiName"}},[a("el-tab-pane",{key:e.apiName,attrs:{label:e.apiName,name:e.apiName}}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.apiModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"接口名称",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"auto-complete":"true",placeholder:"接口名称"},model:{value:e.apiModel.type,callback:function(t){e.$set(e.apiModel,"type",t)},expression:"apiModel.type"}},e._l(e.apiCategory,function(t,i){return a("el-option",{key:i,attrs:{label:e.setName(t),value:t.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"接口描述",prop:"desc"}},[a("el-input",{attrs:{placeholder:"接口描述"},model:{value:e.apiModel.desc,callback:function(t){e.$set(e.apiModel,"desc",t)},expression:"apiModel.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接口地址",prop:"href"}},[a("el-input",{attrs:{placeholder:"接口地址"},model:{value:e.apiModel.href,callback:function(t){e.$set(e.apiModel,"href",t)},expression:"apiModel.href"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接口方法",prop:"method"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"接口方法"},model:{value:e.apiModel.method,callback:function(t){e.$set(e.apiModel,"method",t)},expression:"apiModel.method"}},e._l(e.methodLists,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"请求字段",prop:"request"}},[a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"medium"},on:{click:function(t){return e.requestAdd()}}}),e._v(" "),e._l(e.apiModel.request,function(t,i){return a("div",{key:i},[a("el-input",{staticStyle:{width:"195px","margin-bottom":"5px"},attrs:{"auto-complete":"true",placeholder:"参数名"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"request.name"}}),e._v(" "),a("el-select",{staticStyle:{width:"195px"},attrs:{"auto-complete":"true",placeholder:"字段类型"},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"request.type"}},e._l(e.typeLists,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1),e._v(" "),a("el-select",{staticStyle:{width:"195px"},attrs:{placeholder:"是否必须"},model:{value:t.required,callback:function(a){e.$set(t,"required",a)},expression:"request.required"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1),e._v(" "),a("el-input",{staticStyle:{width:"195px"},attrs:{"auto-complete":"true",placeholder:"参数描述"},model:{value:t.desc,callback:function(a){e.$set(t,"desc",a)},expression:"request.desc"}}),e._v(" "),a("el-input",{staticStyle:{width:"195px"},attrs:{"auto-complete":"true",placeholder:"参数值"},model:{value:t.val,callback:function(a){e.$set(t,"val",a)},expression:"request.val"}}),e._v(" "),a("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"medium"},on:{click:function(a){return e.requestRemove(t,i)}}})],1)})],2),e._v(" "),a("el-form-item",{attrs:{label:"返回参数",prop:"response_string"}},[a("codemirror",{ref:"edit",staticStyle:{"line-height":"20px"},attrs:{value:e.apiModel.response_string,options:e.options},on:{change:e.updateContent}})],1),e._v(" "),a("el-form-item",{attrs:{label:"返回字段",prop:"response"}},[a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"medium"},on:{click:function(t){return e.responseAdd()}}}),e._v(" "),e._l(e.apiModel.response,function(t,i){return a("div",{key:i},[a("el-input",{staticStyle:{width:"195px","margin-bottom":"5px"},attrs:{"auto-complete":"true",placeholder:"参数名"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"response.name"}}),e._v(" "),a("el-select",{staticStyle:{width:"195px"},attrs:{"auto-complete":"true",placeholder:"字段类型"},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"response.type"}},e._l(e.typeLists,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1),e._v(" "),a("el-input",{staticStyle:{width:"200px"},attrs:{"auto-complete":"true",placeholder:"参数描述"},model:{value:t.desc,callback:function(a){e.$set(t,"desc",a)},expression:"response.desc"}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"medium"},on:{click:function(a){return e.responseRemove(t,i)}}})],1)})],2),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注",type:"textarea"},model:{value:e.apiModel.remark,callback:function(t){e.$set(e.apiModel,"remark",t)},expression:"apiModel.remark"}})],1),e._v(" "),a("Submit",{staticStyle:{"text-align":"center"},attrs:{reFrom:e.reFrom,model:e.apiModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}]},[a("el-menu",{staticClass:"menu",staticStyle:{"border-bottom":"solid 1px #393d49"},attrs:{id:"menu","background-color":"#393d49","text-color":"#cccccc",mode:"horizontal","active-text-color":"#ffd04b"}},[a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.add,expression:"btn.add"}],on:{click:e.addCategory}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添 加")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.edit,expression:"btn.edit"}],on:{click:e.updateCategory}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v("修 改")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.del,expression:"btn.del"}],on:{click:e.deleteCategory}},[a("i",{staticClass:"el-icon-delete-solid"}),e._v("删 除")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.categoryModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"接口名称",prop:"name",required:""}},[a("el-input",{attrs:{placeholder:"分类名称"},model:{value:e.categoryModel.name,callback:function(t){e.$set(e.categoryModel,"name",t)},expression:"categoryModel.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接口上级",prop:"pid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"接口上级"},model:{value:e.categoryModel.pid,callback:function(t){e.$set(e.categoryModel,"pid",t)},expression:"categoryModel.pid"}},["0"===e.categoryModel.pid?a("el-option",{attrs:{label:"默认权限",value:"0",selected:""}}):e._e(),e._v(" "),e._l(e.apiCategory,function(t,i){return a("el-option",{key:i,attrs:{label:e.setName(t),value:t.id}})})],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.categoryModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var We=a("VU/8")(Ie,Pe,!1,function(e){a("w2gl")},"data-v-165eda40",null).exports,He={name:"doc",components:{Submit:ie,Delete:ce},data:function(){return{categoryLists:[],props:{label:"name",children:"children",id:"id"},filterText:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"category",apiName:"README",menuVisible:!1,categoryModel:{},apiCategory:[],highlight:!0,value:"",mavonBool:!1,open:"preview",codeStyle:"monokai",cgi:{categoryInsert:g.categorySave,categoryUpdate:g.categoryUpdate,remove:g.categoryDelete,uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload},scrollTop:0,btn:{},token:"",codeStyleList:a("6ZH5")}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:m()({},Object(p.c)(["docVisible","docModel","docName"])),methods:m()({},Object(p.b)(["addDocVisible","addDocModel","saveSystemLog"]),{success:function(){this.getCategoryLists(),this.syncVisible=!1},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},setName:function(e){return Array(e.level+1).join("　　")+e.name},getCategoryLists:function(){var e=this;N.CategoryLists({}).then(function(t){t&&200===t.data.code&&(e.apiCategory=t.data.item.category,e.categoryLists=t.data.item.category_tree,e.docModel.id||(e.apiName=e.categoryLists[0].name,e.getApiDetail(e.categoryLists[0])),e.loading=!1)})},rightClick:function(e,t,a,i){this.menuVisible=!1,this.menuVisible=!0;var s=document.querySelector("#menu");this.scrollTop=M.a.get_scroll_top(),document.addEventListener("click",this.foo),s.style.left="290px",s.style.top=e.clientY+this.scrollTop-125+"px",this.categoryModel=t},foo:function(){this.menuVisible=!1,document.removeEventListener("click",this.foo)},addCategory:function(){this.title="添加接口",this.syncVisible=!0,this.url=this.cgi.categoryInsert,this.categoryModel={name:"",pid:void 0===this.categoryModel.id?"0":this.categoryModel.id,path:"1",level:1}},updateCategory:function(){this.title=this.categoryModel.name,this.syncVisible=!0,this.url=this.cgi.categoryUpdate},deleteCategory:function(){var e=this;N.CategoryDelete({id:this.categoryModel.id}).then(function(t){if(t&&200===t.data.code){var a={href:e.cgi.remove,msg:t.data.msg,token:e.$store.state.login.token};e.saveSystemLog(a),e.$message({type:"success",message:t.data.msg}),e.getCategoryLists()}})},uploadFile:function(e,t){var a=this,i=t.type;if(!["image/jpg","image/gif","image/png","image/jpeg"].includes(i))return this.$message({type:"warning",message:"upload image format error"}),!1;if(t.size>2097152)return this.$message({type:"warning",message:"upload image size error"}),!1;var s=new FormData;s.append("file",t),s.append("token",this.token),s.append("rand",!0);var n={headers:{"Content-Type":"multipart/form-data",Authorization:""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+this.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12))}};this.$http.post(this.cgi.uploadUrl,s,n).then(function(t){a.$refs.md.$img2Url(e,t.data.item.src)})},getData:function(e,t){this.docModel.markdown=e,this.docModel.html=t},saveData:function(){var e=this;this.docModel.id?N.ApiDocUpdate(this.docModel).then(function(t){if(t&&200===t.data.code){e.addDocModel(e.docModel);var a={href:g.apiDocUpdate,msg:t.data.msg,token:e.$store.state.login.token};e.saveSystemLog(a),e.$message.success(t.data.msg)}}):N.ApiDocSave(this.docModel).then(function(t){if(t&&200===t.data.code){e.$message.success(t.data.msg),e.addDocModel(e.docModel);var a={href:g.apiDocSave,msg:t.data.msg,token:e.$store.state.login.token};e.saveSystemLog(a),e.getCategoryLists()}})},getApiDetail:function(e){var t=this,a={docVisible:!0,docName:e.name};this.addDocVisible(a),this.mavonBool=!1,this.$refs.md&&"undefined"!==this.$refs.md&&this.$refs.md.markdownIt.set({breaks:!1}),this.apiName=this.docName,N.ApiDocLists({type:e.id}).then(function(a){a&&200===a.data.code?t.addDocModel(a.data.item):(t.mavonBool=!0,t.addDocModel({}),t.docModel.type=e.id)})}}),created:function(){this.docName&&(this.apiName=this.docName),this.token=this.$store.state.login.token},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getCategoryLists()})}},Ge={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xl:{span:4},lg:{span:4},md:{span:24},sm:{span:24},xs:{span:24}}},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字搜索"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-plus"},on:{click:e.addCategory},slot:"append"})],1),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"background-color":"#393d49"},attrs:{props:e.props,"filter-node-method":e.filterNode,"highlight-current":e.highlight,data:e.categoryLists,"default-expand-all":"","node-key":e.props.id},on:{"node-contextmenu":e.rightClick,"node-click":e.getApiDetail}})],1),e._v(" "),a("el-col",{attrs:{xl:{span:19,push:1},lg:{span:19,push:1},md:{span:24},sm:{span:24},xs:{span:24}}},[e.docVisible?a("el-tabs",{attrs:{type:"border-card"},model:{value:e.apiName,callback:function(t){e.apiName=t},expression:"apiName"}},[a("el-tab-pane",{key:e.apiName,attrs:{label:e.apiName,name:e.apiName}}),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("el-form",[a("el-form-item",{attrs:{inline:!0}},[e.mavonBool?a("el-select",{model:{value:e.codeStyle,callback:function(t){e.codeStyle=t},expression:"codeStyle"}},e._l(e.codeStyleList,function(e,t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1):e._e(),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{plain:"",type:"primary",icon:"el-icon-edit-outline"},on:{click:function(t){e.mavonBool=!e.mavonBool}}},[e._v("修 改")])],1),e._v(" "),a("el-form-item",[a("mavon-editor",{ref:"md",staticStyle:{"z-index":"1","min-height":"500px"},attrs:{defaultOpen:e.open,subfield:e.mavonBool,toolbarsFlag:e.mavonBool,codeStyle:e.codeStyle},on:{imgAdd:e.uploadFile,change:e.getData,save:e.saveData},model:{value:e.docModel.markdown,callback:function(t){e.$set(e.docModel,"markdown",t)},expression:"docModel.markdown"}})],1)],1)],1)],1):e._e()],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}]},[a("el-menu",{staticClass:"menu",staticStyle:{"border-bottom":"solid 1px #393d49"},attrs:{id:"menu","background-color":"#393d49","text-color":"#cccccc",mode:"horizontal","active-text-color":"#ffd04b"}},[a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.add,expression:"btn.add"}],on:{click:e.addCategory}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("添 加")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.edit,expression:"btn.edit"}],on:{click:e.updateCategory}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v("修 改")]),e._v(" "),a("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.btn.del,expression:"btn.del"}],on:{click:e.deleteCategory}},[a("i",{staticClass:"el-icon-delete-solid"}),e._v("删 除")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.categoryModel}},[a("el-form-item",{attrs:{label:"接口名称",prop:"name",required:""}},[a("el-input",{attrs:{placeholder:"分类名称"},model:{value:e.categoryModel.name,callback:function(t){e.$set(e.categoryModel,"name",t)},expression:"categoryModel.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"接口上级",prop:"pid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"接口上级"},model:{value:e.categoryModel.pid,callback:function(t){e.$set(e.categoryModel,"pid",t)},expression:"categoryModel.pid"}},["0"===e.categoryModel.pid?a("el-option",{attrs:{label:"默认权限",value:"0",selected:""}}):e._e(),e._v(" "),e._l(e.apiCategory,function(t,i){return a("el-option",{key:i,attrs:{label:e.setName(t),value:t.id}})})],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.categoryModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var Ye=a("VU/8")(He,Ge,!1,function(e){a("Cn0l")},"data-v-b56fd352",null).exports,Ke={name:"lists",data:function(){return{databaseLists:[],labelWidth:"80px",loading:!0,loadingText:"玩命加载中。。。",edit:!1,name:"",search:"",btn:{}}},methods:m()({},Object(p.b)(["saveSystemLog"]),{getDatabaseLists:function(){var e=this;N.DatabaseLists([]).then(function(t){t&&200===t.data.code&&(e.databaseLists=t.data.item,e.loading=!1)})},backup:function(e){var t=this;this.loading=!0,this.edit=!1,N.DatabaseBackup(e).then(function(e){if(e&&200===e.data.code){setTimeout(function(){t.loading=!1,t.$message({type:"success",message:e.data.msg})},e.data.item.times);var a={href:e.config.url,msg:e.data.msg,token:t.$store.state.login.token};t.saveSystemLog(a)}})},setComment:function(e){this.name=e.name,this.edit=!0},updateComment:function(e){var t=this;if(!e.comment)return this.$message.warning("请输入数据表备注"),this.$refs.comment.focus(),!1;this.loading=!0,N.DatabaseUpdateComment(e).then(function(e){if(e&&200===e.data.code){t.loading=!1,t.$message({type:"success",message:e.data.msg}),t.edit=!1,t.name="";var a={href:e.config.url,msg:e.data.msg,token:t.$store.state.login.token};t.saveSystemLog(a)}})},repair:function(e){var t=this;this.loading=!0,this.edit=!1,N.DatabaseRepair(e).then(function(e){if(e&&200===e.data.code){t.loading=!1,t.$message({type:"success",message:e.data.msg});var a={href:e.config.url,msg:e.data.msg,token:t.$store.state.login.token};t.saveSystemLog(a)}})},optimize:function(e){var t=this;this.loading=!0,this.edit=!1,N.DatabaseOptimize(e).then(function(e){if(e&&200===e.data.code){t.loading=!1,t.$message({type:"success",message:e.data.msg});var a={href:e.config.url,msg:e.data.msg,token:t.$store.state.login.token};t.saveSystemLog(a)}})}}),mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getDatabaseLists()})}},Je={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-table",{attrs:{data:e.databaseLists.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"表名",prop:"name",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"版本号",prop:"version",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"引擎",prop:"engine",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"数据表大小",prop:"data_length",sortable:"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"自增量",prop:"auto_increment",sortable:"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"字符集编码",prop:"collation"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.name===e.name&&e.edit?a("el-input",{ref:"comment",attrs:{id:t.row.name,placeholder:"请输入数据表备注"},model:{value:t.row.comment,callback:function(a){e.$set(t.row,"comment",a)},expression:"scope.row.comment"}}):a("div",{domProps:{innerHTML:e._s(t.row.comment)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",sortable:"",prop:"create_time"}}),e._v(" "),a("el-table-column",{attrs:{width:"350px",align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[a("el-button-group",[t.row.name===e.name&&e.edit&&e.btn.comment?a("el-button",{attrs:{round:"",type:"primary",plain:"",size:"small",icon:"el-icon-edit-outline"},on:{click:function(a){return e.updateComment(t.row)}}},[e._v("更 新")]):e.btn.comment?a("el-button",{attrs:{round:"",type:"primary",plain:"",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.setComment(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.backup?a("el-button",{attrs:{round:"",type:"primary",plain:"",size:"small"},on:{click:function(a){return e.backup(t.row)}}},[e._v("备 份")]):e._e(),e._v(" "),e.btn.repair?a("el-button",{attrs:{round:"",type:"primary",plain:"",size:"small"},on:{click:function(a){return e.repair(t.row)}}},[e._v("修 复")]):e._e(),e._v(" "),e.btn.optimize?a("el-button",{attrs:{round:"",type:"primary",plain:"",size:"small"},on:{click:function(a){return e.optimize(t.row)}}},[e._v("优 化")]):e._e()],1)]}}])})],1)],1)},staticRenderFns:[]};var Qe=a("VU/8")(Ke,Je,!1,function(e){a("4EOK")},"data-v-488aacac",null).exports,Ze={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe,Upload:be},data:function(){return{oauthLists:[],roleLists:[],page:1,limit:15,total:0,search:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"role",OauthModel:{},oauthImageLists:[],fileData:{},showCode:!1,showPassword:!1,oauthVisible:!1,dialogWidth:"50%",cgi:{remove:g.oauthDelete,status:g.oauthUpdate,update:g.oauthUpdate,uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload},rules:{username:[{required:!0,message:"用户名不得为空",trigger:"blur"}],avatar_url:[{required:!0,message:"用户头像不得为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不得为空",trigger:"blur"}],code:[{required:!0,message:"验证码不得为空",trigger:"blur"}],remember_token:[{required:!0,message:"授权TOKEN不得为空",trigger:"blur"}]},headers:{},onlineUser:[],btn:{}}},computed:m()({},Object(p.c)(["token","username","oauthConfig"])),methods:m()({},Object(p.b)(["getOauthConfig","addTabs","addCurrTabs"]),{oauthLogin:function(){this.oauthVisible=!0,this.getOauthConfig("oauth")},goto:function(e){var t=this;N.OauthBind({oauth_type:e,remember_token:this.token}).then(function(e){if(e&&200===e.data.code)if(e.data.item.oauth_url)window.open(e.data.item.oauth_url);else{var a={label:"账户绑定",name:e.data.item.local};console.log(a),t.activeName=a.name,t.addCurrTabs(a),t.addTabs(a),t.$router.push({path:a.name})}})},success:function(){this.syncVisible=!1,this.getOauthLists(this.page,this.limit)},uploadSuccess:function(e){this.OauthModel.avatar_url=e},getOauthLists:function(e,t){var a=this,i={page:e,limit:t};N.OauthLists(i).then(function(e){e&&200===e.data.code&&(a.oauthLists=e.data.item.data,a.total=e.data.item.total,a.loading=!1)})},sendMail:function(e){var t=this;if(!e.email)return this.$refs.bindEmail.focus(),void this.$message.warning("Please Enter Email");var a={email:e.email,id:e.id,username:e.username,remember_token:e.remember_token};N.SendEmail(a).then(function(e){e&&200===e.data.code&&(t.$message({type:"success",message:e.data.msg}),t.showCode=!0)})},checkCode:function(e){var t=this;if(!e.code)return this.$refs.bindCode.focus(),void this.$message.warning("Please Enter Code");if(!Q()(e.code))return this.$refs.bindCode.focus(),void this.$message.warning("verification code format error");if(e.code.length>6)return this.$refs.bindCode.focus(),void this.$message.warning("Wrong verification code length");var a={code:e.code,id:e.id};N.VerifyCode(a).then(function(a){a&&200===a.data.code?t.$message({type:"success",message:a.data.msg}):e.code=""})},sizeChange:function(e){this.limit=e,this.getOauthLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getOauthLists(this.page,this.limit)},updateOauth:function(e){this.title="修改授权用户",this.syncVisible=!0,this.OauthModel=e,this.showCode=!1,this.url=this.cgi.update}}),mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getOauthLists(this.page,this.limit)})}},Xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.oauthLogin}},[e._v("账号绑定")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.oauthLists.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())||t.oauth_type.toLowerCase().includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"#ID",prop:"id",width:"100",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",prop:"username","show-tooltip-when-overflow":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"头像",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.avatar_url,fit:"cover",title:e.row.username,"preview-src-list":[e.row.avatar_url]}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户邮箱",align:"center",prop:"email","show-tooltip-when-overflow":""}}),e._v(" "),a("el-table-column",{attrs:{label:"账号来源",align:"center",prop:"oauth_type"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"160",prop:"created_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",align:"center",width:"160",prop:"updated_at"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"right",width:"200"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateOauth(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.oauthLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.OauthModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名称",prop:"username"}},[a("el-input",{model:{value:e.OauthModel.username,callback:function(t){e.$set(e.OauthModel,"username",t)},expression:"OauthModel.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像",prop:"avatar_url"}},[a("Upload",{attrs:{avatar_url:e.OauthModel.avatar_url,username:e.OauthModel.username},on:{uploadSuccess:e.uploadSuccess}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权标识",prop:"remember_token"}},[a("el-input",{attrs:{type:e.showPassword?"":"password",readonly:""},model:{value:e.OauthModel.remember_token,callback:function(t){e.$set(e.OauthModel,"remember_token",t)},expression:"OauthModel.remember_token"}},[a("el-button",{attrs:{slot:"append",icon:e.showPassword?"el-icon-open":"el-icon-turn-off"},on:{click:function(t){e.showPassword=!e.showPassword}},slot:"append"},[e._v("\n                        "+e._s(e.showPassword?"显 示":"隐 藏")+"\n                    ")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱账号",prop:"email"}},[a("el-input",{ref:"bindEmail",model:{value:e.OauthModel.email,callback:function(t){e.$set(e.OauthModel,"email",t)},expression:"OauthModel.email"}},[e.OauthModel.code?a("el-button",{attrs:{slot:"append",plain:"",type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.sendMail(e.OauthModel)}},slot:"append"},[e._v("修 改")]):a("el-button",{attrs:{slot:"append",plain:"",type:"primary",icon:"el-icon-circle-plus"},on:{click:function(t){return e.sendMail(e.OauthModel)}},slot:"append"},[e._v("绑 定")])],1)],1),e._v(" "),e.showCode?a("el-form-item",{attrs:{label:"验证码",prop:"code"}},[a("el-input",{ref:"bindCode",attrs:{maxlength:"6"},on:{blur:function(t){return e.checkCode(e.OauthModel)}},model:{value:e.OauthModel.code,callback:function(t){e.$set(e.OauthModel,"code",e._n(t))},expression:"OauthModel.code"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.OauthModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.oauthVisible,title:"授权登录","destroy-on-close":e.destroy_on_close,center:e.center,width:e.dialogWidth},on:{"update:visible":function(t){e.oauthVisible=t}}},e._l(e.oauthConfig,function(t,i){return 1===t.status?a("el-button",{key:i,attrs:{plain:"",type:"primary"},on:{click:function(a){return e.goto(t.name)}}},[e._v(e._s(t.name.toUpperCase()))]):e._e()}),1)],1)},staticRenderFns:[]};var et=a("VU/8")(Ze,Xe,!1,function(e){a("wKAD")},"data-v-f07d5566",null).exports,tt={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe},data:function(){return{reqRuleLists:[],ruleLists:[],userLists:[],page:1,limit:15,total:0,search:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"reqRule",reqRuleModel:{},cgi:{remove:g.reqRuleDelete,status:g.reqRuleUpdate,update:g.reqRuleUpdate,insert:g.reqRuleSave},rules:{username:[{required:!0,message:"申请人不得为空",trigger:"blur"}],href:[{required:!0,message:"授权地址不得为空",trigger:"change"}],expires:[{required:!0,message:"授权时效不得为空",trigger:"change"}],desc:[{required:!0,message:"申请理由不得为空",trigger:"blur"}],status:[{required:!0,message:"授权状态不得为空",trigger:"blur"}]},href:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()},shortcuts:[{text:"一星期",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}},{text:"一个月",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}},{text:"三个月",onClick:function(e){var t=new Date;t.setTime(t.getTime()+7776e6),e.$emit("pick",t)}},{text:"六个月",onClick:function(e){var t=new Date;t.setTime(t.getTime()+15552e6),e.$emit("pick",t)}},{text:"一年",onClick:function(e){var t=new Date;t.setTime(t.getTime()+31104e6),e.$emit("pick",t)}}]},btn:{}}},computed:m()({},Object(p.c)(["username","token"])),methods:{success:function(){this.syncVisible=!1,this.getReqRuleLists(this.page,this.limit)},setTimes:function(e){return M.a.set_time(1e3*e)},getReqRuleLists:function(e,t){var a=this,i={page:e,limit:t};this.loading=!0,N.ReqRuleLists(i).then(function(e){e&&200===e.data.code&&(a.reqRuleLists=e.data.item.data,a.total=e.data.item.total,a.userLists=e.data.item.userLists,a.loading=!1)})},setAuthName:function(e){return Array(e.level+1).join("　　")+e.name},sizeChange:function(e){this.limit=e,this.getReqRuleLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getReqRuleLists(this.page,this.limit)},addReqRule:function(){this.title="权限申请",this.syncVisible=!0,this.reqRuleModel={username:"",href:"",desc:"",expires:"",status:1},this.url=this.cgi.insert,this.href=!1},getAuth:function(e){var t=this,a={user_id:e};N.GetAuthByToken(a).then(function(e){e&&200===e.data.code&&(t.ruleLists=e.data.item,t.href=!0)})},updateReqRule:function(e){this.title="权限续期",this.syncVisible=!0,this.reqRuleModel=e,this.reqRuleModel.href=[this.reqRuleModel.href],this.ruleLists=this.reqRuleModel.ruleLists,this.url=this.cgi.update,this.href=!0}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getReqRuleLists(this.page,this.limit)})}},at={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[e.btn.add?a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addReqRule}},[e._v("添 加")])],1)],1):e._e(),e._v(" "),a("el-table",{attrs:{data:e.reqRuleLists.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())||t.href.includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"#",prop:"id",width:"120px",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"申请人",prop:"username",width:"150px"}}),e._v(" "),a("el-table-column",{attrs:{label:"授权地址",prop:"href"}}),e._v(" "),"admin"===e.username?a("el-table-column",{attrs:{label:"授权状态",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Radio",{attrs:{item:t.row,url:e.cgi.status},on:{success:e.success}})]}}],null,!1,1057654114)}):e._e(),e._v(" "),"admin"!==e.username?a("el-table-column",{attrs:{label:"授权状态",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-button",{attrs:{type:"success",size:"mini"}},[e._v("已授权")]):e._e(),e._v(" "),2===t.row.status?a("el-button",{attrs:{type:"info",size:"mini"}},[e._v("未授权")]):e._e()]}}],null,!1,3706176486)}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"created_at",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",prop:"updated_at",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"权限时效",prop:"expires",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200px",align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键字查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[1===t.row.status&&e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:function(a){return e.updateReqRule(t.row)}}},[e._v("续 期")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.reqRuleLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.reqRuleModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"申请人",prop:"username"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},on:{change:e.getAuth},model:{value:e.reqRuleModel.username,callback:function(t){e.$set(e.reqRuleModel,"username",t)},expression:"reqRuleModel.username"}},e._l(e.userLists,function(e,t){return a("el-option",{key:t,attrs:{label:e.username,value:e.id}})}),1)],1),e._v(" "),e.href?a("el-form-item",{attrs:{label:"授权地址",prop:"href"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"multiple",filterable:""},model:{value:e.reqRuleModel.href,callback:function(t){e.$set(e.reqRuleModel,"href",t)},expression:"reqRuleModel.href"}},e._l(e.ruleLists,function(t,i){return a("el-option",{key:i,attrs:{label:e.setAuthName(t),value:t.href,disabled:t.disable}})}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"授权时间",prop:"expires"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择授权时间","picker-options":e.pickerOptions},model:{value:e.reqRuleModel.expires,callback:function(t){e.$set(e.reqRuleModel,"expires",t)},expression:"reqRuleModel.expires"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权说明",prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.reqRuleModel.desc,callback:function(t){e.$set(e.reqRuleModel,"desc",t)},expression:"reqRuleModel.desc"}})],1),e._v(" "),"admin"===e.username?a("el-form-item",{attrs:{label:"是否授权",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.reqRuleModel.status,callback:function(t){e.$set(e.reqRuleModel,"status",t)},expression:"reqRuleModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("否")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("是")])],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.reqRuleModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var it=a("VU/8")(tt,at,!1,function(e){a("QPsH")},"data-v-2a3aa8aa",null).exports,st={name:"lists",data:function(){return{areaLists:[],loading:!0,loadingText:"玩命加载中。。。",search:"",pid:1}},methods:{getAreaLists:function(e){var t=this;N.AreaLists({parent_id:e},g.areaIndex).then(function(e){e&&200===e.data.code&&(t.areaLists=e.data.item,t.loading=!1)})},load:function(e,t,a){N.AreaLists({parent_id:e.id},g.areaIndex).then(function(e){e&&200===e.data.code&&setTimeout(function(){a(e.data.item)},500)})},getWeather:function(e){var t={code:e.code,id:e.id};N.AreaWeather(t).then(function(e){e&&200===e.data.code&&console.log(e)})}},mounted:function(){this.$nextTick(function(){this.getAreaLists(this.pid)})}},nt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-table",{attrs:{data:e.areaLists.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())}),"row-key":"id","tree-props":{children:"__child",hasChildren:"hasChildren"},lazy:"",load:e.load}},[a("el-table-column",{attrs:{label:"地区名称",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"天气"}}),e._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(a){return e.getWeather(t.row)}}},[e._v("点击查看")])]}}])})],1)],1)},staticRenderFns:[]};var ot=a("VU/8")(st,nt,!1,function(e){a("Cw02")},"data-v-51443ba2",null).exports,rt={name:"lists",components:{Submit:ie,Delete:ce,Radio:oe},data:function(){return{pushLists:[],page:1,limit:15,state:"",status:"",total:0,search:"",oauthLists:[],title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",url:"",refs:this.$refs,reFrom:"push",pushModel:{},cgi:{insert:g.pushSave,update:g.pushUpdate,remove:g.pushDelete,status:g.pushUpdate},rules:{info:[{required:!0,message:"站内通知不得为空",trigger:"blur"}],title:[{required:!0,message:"站内通知标题不得为空",trigger:"blur"}]},pushState:[{val:"successfully",label:"成功",type:"success"},{val:"failed",label:"失败",type:"danger"},{val:"offline",label:"离线",type:"default"}],btn:{}}},computed:m()({},Object(p.c)(["username"])),methods:{success:function(){this.syncVisible=!1,this.getPushLists(this.page,this.limit)},filterStatus:function(e,t){return t.status.toString()===e},setType:function(e){var t="";switch(e){case"failed":t="danger";break;case"successfully":t="success";break;case"offline":t="default"}return t},getPushLists:function(e,t){var a=this,i={page:e,limit:t,state:this.state,status:this.status};N.PushList(i).then(function(e){a.pushLists=e.data.item.data,a.total=e.data.item.total,a.oauthLists=e.data.item.oauth}),this.loading=!1},changeOauthName:function(e){this.pushModel.uid="all"!==e?e:""},getState:function(e){this.state=e,this.getPushLists(1,this.limit)},sizeChange:function(e){this.limit=e,this.getPushLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getPushLists(this.page,this.limit)},addPush:function(){this.title="添加站内通知",this.syncVisible=!0,this.pushModel={username:"all",uid:"",state:"",status:2,created_at:M.a.set_time(new Date),title:"系统通知"},this.url=this.cgi.insert},updatePush:function(e){this.title="修改站内通知",this.syncVisible=!0,this.pushModel=e,this.url=this.cgi.update}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getPushLists(this.page,this.limit)})}},lt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",e._l(e.pushState,function(t,i){return a("el-button",{key:i,attrs:{type:t.type,size:"medium",plain:""},on:{click:function(a){return e.getState(t.val)}}},[e._v(e._s(t.val.toUpperCase()))])}),1),e._v(" "),e.btn.add?a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addPush}},[e._v("添 加")])],1):e._e()],1),e._v(" "),a("el-table",{attrs:{data:e.pushLists.filter(function(t){return!e.search||t.username.toLowerCase().includes(e.search.toLowerCase())||t.info.toLowerCase().includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{label:"#",prop:"id",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"目标用户",prop:"username",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{label:"推送类型",prop:"title",width:"150px"}}),e._v(" "),a("el-table-column",{attrs:{label:"推送内容",prop:"info","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"实时",width:"80px",filters:[{text:"是",value:"1"},{text:"否",value:"2"}],"filter-method":e.filterStatus},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.status?a("el-button",{attrs:{plain:"",type:"primary",size:"mini"}},[e._v("否")]):e._e(),e._v(" "),1===t.row.status?a("el-button",{attrs:{plain:"",type:"success",size:"mini"}},[e._v("是")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"推送状态",prop:"state",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",type:e.setType(t.row.state),size:"mini"}},[e._v(e._s(t.row.state.toUpperCase()))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"时间",prop:"created_at",width:"200px"}}),e._v(" "),a("el-table-column",{attrs:{width:"200px",align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return["successfully"!==t.row.state&&e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updatePush(t.row)}}},[e._v("执 行")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.pushLists},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.pushModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},on:{change:e.changeOauthName},model:{value:e.pushModel.username,callback:function(t){e.$set(e.pushModel,"username",t)},expression:"pushModel.username"}},[a("el-option",{attrs:{label:"所有人",value:"all"}}),e._v(" "),e._l(e.oauthLists,function(e,t){return a("el-option",{key:t,attrs:{label:e.username,value:e.uuid}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"UUID",prop:"uid"}},[a("el-input",{attrs:{readonly:"",placeholder:"用户UUID"},model:{value:e.pushModel.uid,callback:function(t){e.$set(e.pushModel,"uid",t)},expression:"pushModel.uid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"推送标题"},model:{value:e.pushModel.title,callback:function(t){e.$set(e.pushModel,"title",t)},expression:"pushModel.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时间",prop:"created_at"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss"},model:{value:e.pushModel.created_at,callback:function(t){e.$set(e.pushModel,"created_at",t)},expression:"pushModel.created_at"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"消息",prop:"info"}},[a("el-input",{attrs:{placeholder:"推送消息",type:"textarea",resize:"none",rows:"4"},model:{value:e.pushModel.info,callback:function(t){e.$set(e.pushModel,"info",t)},expression:"pushModel.info"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"实时推送",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.pushModel.status,callback:function(t){e.$set(e.pushModel,"status",t)},expression:"pushModel.status"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("否")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("是")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.pushModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var ct=a("VU/8")(rt,lt,!1,function(e){a("SXhf")},"data-v-fb801ae0",null).exports,ut={name:"lists",components:{Delete:ce},data:function(){return{chatLists:[],page:1,limit:15,total:0,title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",cgi:{remove:g.remove,status:g.status},rules:{}}},methods:{unescape:function(e){return e.replace(e?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;nbsp;/g," ").replace(/&#39;/g,"'")},success:function(){this.syncVisible=!1},setTimes:function(e){return M.a.set_time(1e3*e)},getChatLists:function(e,t){var a=this;N.ChatLists({page:e,limit:t}).then(function(e){a.loading=!1,a.chatLists=e.data.item.data,a.total=e.data.item.total})},sizeChange:function(e){this.limit=e,this.getChatLists(this.page,this.limit)},currentChange:function(e){this.page=e,this.getChatLists(this.page,this.limit)}},mounted:function(){this.$nextTick(function(){this.getChatLists(this.page,this.limit)})}},dt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}}),e._v(" "),a("el-table",{attrs:{data:e.chatLists}},[a("el-table-column",{attrs:{label:"#",prop:"id",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"发送者",prop:"from_client_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-avatar",{attrs:{src:e.row.avatar_url}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"接收者",prop:"to_client_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"消息体",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{height:"80px"},domProps:{innerHTML:e._s(e.unescape(t.row.content))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"消息类型",prop:"msg_type"}}),e._v(" "),a("el-table-column",{attrs:{label:"发送时间",prop:"time"}}),e._v(" "),a("el-table-column",{attrs:{label:"房间号",prop:"room_id"}})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},staticRenderFns:[]};var mt=a("VU/8")(ut,dt,!1,function(e){a("ZiCH")},"data-v-4d31b628",null).exports,pt={name:"markdown",data:function(){return{value:'```JavaScript\n<template>\n    <mavon-editor @imgAdd="uploadFile" ref="md" v-model="value"/>\n</template>\n\n<script>\n    import $url from "../../api/url"\n    import func from "../../api/func"\n    export default {\n        name: "markdown",\n        data(){\n            return {\n                value:"",\n                uploadUrl:process.env.API_ROOT+$url.fileUpload,\n                token:""\n            }\n        },\n        created(){\n            this.token = this.$store.state.login.token;\n        },\n        methods:{\n            /**\n             * TODO:图片上传\n             * @param post\n             * @param file\n             */\n            uploadFile:function (post,file) {\n                let type = file.type;\n                let typeArr = ["image/jpg","image/gif","image/png","image/jpeg"];\n                if (!typeArr.includes(type)){\n                    this.$message({type:"warning",message:"upload image format error"});\n                    return false;\n                }\n                if (file.size>2*1024*1024){\n                    this.$message({type:"warning",message:"upload image size error"});\n                    return false;\n                }\n                let params = new FormData();\n                params.append("file",file);\n                params.append("token",this.token);\n                params.append("rand",true);\n                let config = {headers: {"Content-Type": "multipart/form-data","Authorization":`${func.set_password(func.set_random(32),func.set_random(12))}${this.token}${func.set_password(func.set_random(32),func.set_random(12))}`}}\n                this.$http.post(this.uploadUrl,params,config).then(response=>{\n                    this.$refs["md"].$img2Url(post, response.data.item.src);\n                })\n            },\n        },\n    }\n<\/script>\n```',uploadUrl:"https://www.fanglonger.com/api/"+g.fileUpload.replace("/",""),token:""}},created:function(){this.token=this.$store.state.login.token},methods:{uploadFile:function(e,t){var a=this,i=t.type;if(!["image/jpg","image/gif","image/png","image/jpeg"].includes(i))return this.$message({type:"warning",message:"upload image format error"}),!1;if(t.size>2097152)return this.$message({type:"warning",message:"upload image size error"}),!1;var s=new FormData;s.append("file",t),s.append("token",this.token),s.append("rand",!0);var n={headers:{"Content-Type":"multipart/form-data",Authorization:""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+this.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12))}};this.$http.post(this.uploadUrl,s,n).then(function(t){a.$refs.md.$img2Url(e,t.data.item.src)})},getData:function(e,t){console.log(e,t)}}},ht={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("mavon-editor",{ref:"md",staticStyle:{"z-index":"1"},on:{imgAdd:e.uploadFile,change:e.getData},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},staticRenderFns:[]};var ft=a("VU/8")(pt,ht,!1,function(e){a("+z27")},"data-v-8559a3ce",null).exports,gt={action:"https://www.fanglonger.com/api/"+g.fileUpload.replace("/",""),methods:"POST",token:localStorage.token,name:"file",size:2,rand:!0,accept:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon, image/jpg"},vt={placeholder:"Compose an epic...",theme:"snow",modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],handlers:{image:function(){var e=this,t=this.container.querySelector("input.ql-image[type=file]");null===t&&((t=document.createElement("input")).setAttribute("type","file"),gt.name&&t.setAttribute("name",gt.name),t.setAttribute("accept",gt.accept),t.classList.add("ql-image"),t.addEventListener("change",function(){if(gt.size&&t.files[0].size>=1024*gt.size)t.value="";else{var a=new FormData;a.append(gt.name,t.files[0]),gt.token&&a.append("token",gt.token),gt.rand&&a.append("rand",gt.rand);var i=new XMLHttpRequest;i.open(gt.methods,gt.action,!0),i.setRequestHeader("Authorization",""+M.a.set_password(M.a.set_random(32),M.a.set_random(12))+localStorage.token+M.a.set_password(M.a.set_random(32),M.a.set_random(12))),i.upload.onloadstart=function(e){t.value=""},i.onload=function(a){if(200===i.status){var s=JSON.parse(i.responseText),n=e.quill.getSelection(!0).index;e.quill.insertEmbed(n,"image",s.item.src),e.quill.setSelection(n+1)}t.value=""},i.upload.onerror=function(e){},i.upload.onloadend=function(e){},i.send(a)}}),this.container.appendChild(t)),t.click()}}}}},bt={data:function(){return{messages:"",avatar_url:"",editorOption:vt}},methods:{onEditorBlur:function(){console.log("blur",this.messages)},onEditorFocus:function(){console.log("focus",this.messages)},onEditorReady:function(){console.log("ready",this.messages)},onEditorChange:function(e){e.quill,e.html,e.text}}},_t={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"400px","padding-bottom":"40px"},attrs:{options:e.editorOption},on:{blur:function(t){return e.onEditorBlur(t)},focus:function(t){return e.onEditorFocus(t)},change:function(t){return e.onEditorChange(t)},ready:function(t){return e.onEditorReady(t)}},model:{value:e.messages,callback:function(t){e.messages=t},expression:"messages"}})},staticRenderFns:[]};var yt=a("VU/8")(bt,_t,!1,function(e){a("BbBi")},null,null).exports,xt={name:"timeline",components:{Delete:ce,Submit:ie},data:function(){return{timeLineList:[],page:1,limit:15,total:0,search:"",title:"",syncVisible:!1,modal:!0,labelWidth:"80px",loading:!0,destroy_on_close:!0,center:!0,loadingText:"玩命加载中。。。",reFrom:"timeline",timeLineModel:{},refs:this.$refs,url:"",cgi:{save:g.timeLineSave,update:g.timeLineUpdate},rules:{content:[{required:!0,message:"文案不得为空",trigger:"blur"}],timestamp:[{required:!0,message:"时间不得为空",trigger:"change"}]},btn:{},typeLists:[{key:"SUCCESS",val:"success"},{key:"INFO",val:"info"},{key:"PRIMARY",val:"primary"},{key:"DANGER",val:"danger"},{key:"WARNING",val:"warning"}]}},methods:{success:function(){this.syncVisible=!1,this.getTimeLineList(this.page,this.limit)},getTimeLineList:function(e,t){var a=this;N.TimeLineLists({page:e,limit:t}).then(function(e){a.loading=!1,a.timeLineList=e.data.item.data,a.total=e.data.item.total})},addTimeLine:function(){this.syncVisible=!0,this.title="添加时间线",this.timeLineModel={content:"",type:"success",timestamp:M.a.set_time(1e3*M.a.get_timestamp())},this.url=this.cgi.save},editTimeLine:function(e){this.title="修改时间线",this.timeLineModel=e,this.syncVisible=!0,this.url=this.cgi.update},sizeChange:function(e){this.limit=e,this.getTimeLineList(this.page,this.limit)},currentChange:function(e){this.page=e,this.getTimeLineList(this.page,this.limit)}},mounted:function(){this.$nextTick(function(){this.btn=M.a.set_btn_status(this.$route.path,this.$route.name,this.$store.state.login.auth_url),this.getTimeLineList(this.page,this.limit)})}},kt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.loadingText}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form",{staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[e.btn.add?a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium",plain:""},on:{click:e.addTimeLine}},[e._v("添 加")])],1):e._e()],1)],1),e._v(" "),a("el-table",{attrs:{data:e.timeLineList}},[a("el-table-column",{attrs:{label:"#",prop:"id",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"文案",prop:"content"}}),e._v(" "),a("el-table-column",{attrs:{label:"时间",prop:"timestamp"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:t.row.type,size:"mini",plain:""}},[e._v(e._s(t.row.type.toUpperCase()))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"200px",align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入关键词查询"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[e.btn.edit?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.editTimeLine(t.row)}}},[e._v("修 改")]):e._e(),e._v(" "),e.btn.del?a("Delete",{attrs:{url:e.cgi.remove,item:t.row,index:t.$index,Lists:e.timeLineList},on:{success:e.success}}):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"25px 0"}},[a("el-pagination",{attrs:{"page-sizes":[15,30,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"current-page":e.page},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.syncVisible,modal:e.modal,center:e.center,"destroy-on-close":e.destroy_on_close},on:{"update:visible":function(t){e.syncVisible=t}}},[a("el-form",{ref:e.reFrom,attrs:{"label-width":e.labelWidth,model:e.timeLineModel,rules:e.rules}},[a("el-form-item",{attrs:{label:"文案",prop:"content"}},[a("el-input",{attrs:{placeholder:"文案"},model:{value:e.timeLineModel.content,callback:function(t){e.$set(e.timeLineModel,"content",t)},expression:"timeLineModel.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},model:{value:e.timeLineModel.type,callback:function(t){e.$set(e.timeLineModel,"type",t)},expression:"timeLineModel.type"}},e._l(e.typeLists,function(e,t){return a("el-option",{key:t,attrs:{value:e.val,label:e.key}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"时间",prop:"timestamp"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},model:{value:e.timeLineModel.timestamp,callback:function(t){e.$set(e.timeLineModel,"timestamp",t)},expression:"timeLineModel.timestamp"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Submit",{attrs:{reFrom:e.reFrom,model:e.timeLineModel,url:e.url,refs:e.refs},on:{success:e.success}})],1)],1)],1)},staticRenderFns:[]};var wt=a("VU/8")(xt,kt,!1,function(e){a("o8Vj")},"data-v-5dd78ce7",null).exports,Ct={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{"text-align":"center","padding-top":"200px !important"}},[t("img",{staticStyle:{width:"600px"},attrs:{src:a("zAji"),alt:"error"}})])}]};var Lt=a("VU/8")({name:"empty",data:function(){return{}}},Ct,!1,function(e){a("yag7")},"data-v-7115bb13",null).exports,St={name:"Table",components:{Delete:ce},props:{tableData:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},empty:{type:String,default:"暂无数据"},searchOptionsRules:{type:Object,default:function(){}},searchOptions:{type:Array,default:function(){return[]}},searchOption:{type:Object,default:function(){}},remove:{type:String,default:g.componentAction}},methods:m()({},Object(p.b)(["saveSystemLog"]),{search:function(){for(var e in this.searchOptions)this.searchOption[this.searchOptions[e].prop]=this.searchOptions[e].model;this.$emit("search",this.searchOption)},ExcelExport:function(){var e=this;N.ExcelExport(this.searchOption).then(function(t){if(t&&200===t.data.code){var a={href:g.excelExport,msg:t.data.msg,token:e.$store.state.login.token};return e.saveSystemLog(a),e.$message({type:"success",message:t.data.msg}),window.open("https://www.fanglonger.com/api/"+g.fileDownload.replace("/","")+"?token="+e.$store.state.login.token+"&path="+t.data.item.href,"__target"),!1}e.$message({type:"warning",message:t.data.msg})})},removeResource:function(e,t){var a=this;this.$confirm("This operation will always delete the record, whether to continue？","Delete Record",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){N.Remove({id:e.id},a.remove).then(function(e){if(e&&200===e.data.code){a.tableData.splice(t,1);var i={href:a.remove,msg:e.data.msg,token:a.$store.state.login.token};return a.saveSystemLog(i),a.$message({type:"success",message:e.data.msg}),a.$emit("removeSuccess"),!1}a.$message({type:"warning",message:e.data.msg})},function(e){console.log(e)})}).catch(function(){a.$message({type:"info",message:"Cancelled！"})})}}),mounted:function(){this.$nextTick(function(){})}},Mt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{inline:!0,rules:e.searchOptionsRules,model:e.searchOption}},[e._l(e.searchOptions,function(t,i){return"input"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input",{attrs:{placeholder:t.tips},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}})],1):e._e()}),e._v(" "),e._l(e.searchOptions,function(t,i){return"datetime"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-date-picker",{attrs:{type:t.datetype||"daterange","value-format":t.format||"yyyy-MM-dd",format:t.format||"yyyy-MM-dd","start-placeholder":t.tips.split("-")[0],"end-placeholder":t.tips.split("-")[1]},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}})],1):e._e()}),e._v(" "),e._l(e.searchOptions,function(t,i){return"select"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-select",{attrs:{placeholder:t.tips},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}},e._l(t.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1):e._e()}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",plain:"plain"},on:{click:e.search}},[e._v("Search")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-download",type:"primary",plain:"plain"},on:{click:e.ExcelExport}},[e._v("Excel Export")])],1)],2),e._v(" "),a("el-table",{attrs:{data:e.tableData,"empty-text":e.empty,border:""}},[e._l(e.columns,function(e,t){return a("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",label:e.label,prop:e.prop}})}),e._v(" "),a("el-table-column",{attrs:{align:"right",label:"Action"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"look before you leap",placement:"top"}},[a("el-button",{attrs:{plain:"",type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.removeResource(t.row,t.$index)}}},[e._v("Delete")])],1)]}}])})],2)],1)},staticRenderFns:[]};var $t={name:"table-example",components:{TableComponent:a("VU/8")(St,Mt,!1,function(e){a("Bm4g")},"data-v-5836d1fb",null).exports},data:function(){return{columns:[],tableData:[],searchOptions:[],searchOption:{},params:{table:"os_users",lan:"en"}}},methods:{getResource:function(e){var t=this;N.TableComponents(e).then(function(e){for(var a in t.columns=e.data.item.columns,t.tableData=e.data.item.data,t.searchOptions=e.data.item.searchOptions,e.data.item.searchOption)t.searchOption[a]=e.data.item.searchOption[a]})},removeSuccess:function(){this.getResource(this.params)}},mounted:function(){this.$nextTick(function(){this.getResource(this.params)})}},Tt={render:function(){var e=this.$createElement;return(this._self._c||e)("TableComponent",{attrs:{tableData:this.tableData,columns:this.columns,"search-options":this.searchOptions,"search-option":this.searchOption},on:{search:this.getResource,removeSuccess:this.removeSuccess}})},staticRenderFns:[]};var Ot=a("VU/8")($t,Tt,!1,function(e){a("+nwP")},"data-v-9c2e176e",null).exports,Vt={name:"form-component",components:{Submit:ie},props:{formData:{type:Object,default:function(){}},searchOptions:{type:Array,default:function(){return[]}},rules:{type:Object,default:function(){}},labelWidth:{type:String,default:"0"},update:{type:String,default:g.componentAction}},data:function(){return{}},methods:m()({},Object(p.b)(["saveSystemLog"]),{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){for(var a in t.searchOptions)t.formData[t.searchOptions[a].prop]=t.searchOptions[a].model;return t.formData.token=t.$store.state.login.token,N.SaveData(t.formData,t.update).then(function(e){if(e&&200===e.data.code){var a={href:g.componentAction,msg:e.data.msg,token:t.$store.state.login.token};return t.saveSystemLog(a),t.$message({type:"success",message:e.data.msg}),t.$emit("success"),!1}},function(e){console.log(e)}),!0}t.$message({type:"warning",message:"Please check field integrity ~"})})},resetForm:function(e){this.$refs[e].resetFields()}}),mounted:function(){this.$nextTick(function(){console.log(this.formData)})}},Rt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"reFrom",attrs:{model:e.formData,rules:e.rules,"label-width":e.labelWidth}},[e._l(e.searchOptions,function(t,i){return"input"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-input",{attrs:{placeholder:t.tips},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}})],1):e._e()}),e._v(" "),e._l(e.searchOptions,function(t,i){return"datetime"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:t.datetype||"daterange","value-format":t.format||"yyyy-MM-dd",format:t.format||"yyyy-MM-dd","start-placeholder":t.tips.split("-")[0],"end-placeholder":t.tips.split("-")[1]},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}})],1):e._e()}),e._v(" "),e._l(e.searchOptions,function(t,i){return"select"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.tips},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}},["0"===t.model?a("el-option",{attrs:{label:"Default",value:"0",selected:""}}):e._e(),e._v(" "),e._l(t.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1):e._e()}),e._v(" "),e._l(e.searchOptions,function(t,i){return"radio"===t.type?a("el-form-item",{key:i,attrs:{label:t.label,prop:t.prop}},[a("el-radio-group",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"search.model"}},e._l(t.options,function(t,i){return a("el-radio-button",{key:i,attrs:{label:t.label}},[e._v(e._s(t.value))])}),1)],1):e._e()}),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{plain:""},on:{click:function(t){return e.resetForm("reFrom")}}},[e._v("Cancel")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.submitForm("reFrom")}}},[e._v("Confirm")])],1)],2)},staticRenderFns:[]};var Dt={name:"forms",components:{FormComponent:a("VU/8")(Vt,Rt,!1,function(e){a("HAel")},"data-v-1f82d4d1",null).exports},data:function(){return{dialogVisible:!0,formData:{datetime:[],name:"",radio:"1",select:""},searchOptions:[{type:"datetime",label:"DateTime",prop:"datetime",model:[],datetype:"daterange",format:"yyyy-MM-dd",tips:"Please select params - Please select params"},{type:"input",label:"Name",prop:"name",model:"",tips:"Please input params"},{type:"radio",label:"Radio",prop:"radio",model:"1",tips:"Please select params",options:[{label:"1",value:"Close"},{label:"2",value:"Open"}]},{type:"select",label:"Select",prop:"select",model:"",options:[{label:"Successfully",value:"1"},{label:"Offline",value:"2"},{label:"Failed",value:"3"}],tips:"Please select params"}]}}},Ft={render:function(){var e=this.$createElement;return(this._self._c||e)("FormComponent",{attrs:{"search-options":this.searchOptions,"form-data":this.formData}})},staticRenderFns:[]};var Ut=a("VU/8")(Dt,Ft,!1,function(e){a("MHFj")},"data-v-597ecc55",null).exports;n.default.use(u.a);var zt=new u.a({routes:[{path:"/",name:"/",component:ee,meta:{mode:"",title:"登录"}},{path:"/login",name:"Login",component:ee,meta:{mode:"",title:"登录"}},{path:"/404",name:"Empty",component:Lt,meta:{mode:"",title:"404"}},{path:"/admin",name:"Admin",component:P,meta:{mode:"",title:"首页"}},{path:"/admin",component:P,children:[{path:"index/:access_token?",name:"Welcome",component:K,meta:{mode:"",title:"欢迎页"}},{path:"auth/index",name:"AuthLists",component:me,meta:{mode:"rule",title:"权限列表"}},{path:"role/index",name:"RoleLists",component:fe,meta:{mode:"role",title:"角色列表"}},{path:"user/index",name:"UserLists",component:xe,meta:{mode:"user",title:"管理员列表"}},{path:"user/center",name:"UserCenter",component:Ce,meta:{mode:"user_center",title:"个人中心"}},{path:"user/bind/:access_token?",name:"UserBind",component:Me,meta:{mode:"user_bind",title:"账户绑定"}},{path:"oauth/index",name:"OauthLists",component:et,meta:{mode:"oauth",title:"授权列表"}},{path:"req-rule/index",name:"ReqRuleLists",component:it,meta:{mode:"req_rule",title:"申请授权列表"}},{path:"log/index",name:"LogLists",component:Oe,meta:{mode:"log",title:"日志列表"}},{path:"system/log",name:"SystemLog",component:Fe,meta:{mode:"log",title:"系统日志"}},{path:"chat/index",name:"ChatList",component:mt,meta:{mode:"chat",title:"聊天记录"}},{path:"file/index",name:"SystemFile",component:Ne,meta:{mode:"file",title:"文件列表"}},{path:"config/index",name:"ConfigLists",component:Ee,meta:{mode:"config",title:"基础配置"}},{path:"category/index",name:"ApiLists",component:We,meta:{mode:"api_lists",title:"项目列表"}},{path:"apidoc/index",name:"APIDoc",component:Ye,meta:{mode:"api_lists",title:"APIDoc"}},{path:"database/index",name:"DatabaseLists",component:Qe,meta:{mode:"",title:"数据表列表"}},{path:"area/index",name:"AreaLists",component:ot,meta:{mode:"china_area",title:"城市列表"}},{path:"push/index",name:"PushList",component:ct,meta:{mode:"push",title:"站内通知"}},{path:"editor/markdown",name:"MarkDown",component:ft,meta:{mode:"push",title:"MarkDown"}},{path:"editor/quill",name:"UEditor",component:yt,meta:{mode:"push",title:"UEditor"}},{path:"timeline/index",name:"TimeLine",component:wt,meta:{mode:"timeline",title:"时间线"}},{path:"example/table",name:"TableExample",component:Ot,meta:{mode:"",title:"表格组件"}},{path:"example/form",name:"FormExample",component:Ut,meta:{mode:"",title:"表单组件"}}]},{path:"*",redirect:"/404"}]}),Nt=a("NC6I"),At=a.n(Nt),qt=(a("pw1w"),a("OS1Z")),Et=a.n(qt),jt=a("G0J2"),Bt=a.n(jt);a("3f40"),a("4qOc"),a("+cgv");n.default.use(Bt.a),n.default.config.productionTip=!1,n.default.use(Et.a),n.default.use(r.a),n.default.use(u.a),n.default.prototype.$http=D,n.default.prototype.md5=At.a,zt.beforeEach(function(e,t,a){if(e.meta.title&&(document.title=e.meta.title),e.params.access_token&&V.commit("setToken",e.params.access_token),"Login"===e.name||"/"===e.name){if(!V.state.login.token)return void a();N.CheckToken({token:V.state.login.token}).then(function(t){if(t&&t.data.code===L.a.SUCCESS)return a({path:"/admin/index",redirect:e.path}),V.commit("setAuthUrl",t.data.item.auth),V.commit("setToken",t.data.item.token),V.commit("setUserName",t.data.item.username),V.commit("setSocketServer",t.data.item.socket),V.commit("setAvatarUrl",t.data.item.avatar_url),V.commit("setWebsocketServer",t.data.item.websocket),V.commit("setRoleId",t.data.item.role_id),void V.commit("setUUID",t.data.item.uuid);a()})}else N.CheckToken({token:V.state.login.token}).then(function(t){if(t&&t.data.code!==L.a.SUCCESS)return V.commit("setToken",""),void a({path:"/login",redirect:e.path});V.commit("setAuthUrl",t&&t.data&&t.data.item?t.data.item.auth:""),V.commit("setToken",t&&t.data&&t.data.item?t.data.item.token:""),V.commit("setUserName",t&&t.data&&t.data.item?t.data.item.username:""),V.commit("setSocketServer",t&&t.data&&t.data.item?t.data.item.socket:L.a.Socket),V.commit("setAvatarUrl",t&&t.data&&t.data.item?t.data.item.avatar_url:""),V.commit("setWebsocketServer",t&&t.data&&t.data.item?t.data.item.websocket:L.a.Websocket),V.commit("setRoleId",t&&t.data&&t.data.item?t.data.item.role_id:0),V.commit("setUUID",t&&t.data&&t.data.item?t.data.item.uuid:"");if(-1===V.state.login.auth_url.indexOf(e.path)&&!["Welcome","UserBind","Empty"].includes(e.name)){var i="你没有访问权限，请联系管理员【"+L.a.QQ+"】检验数据的正确性";r.a.MessageBox.alert(i).then(function(){var t={username:V.state.login.username,href:[e.path]};N.ReqRuleSave(t).then(function(t){if(t&&t.data.code===L.a.SUCCESS){var a={href:e.path.replace("admin","v1"),msg:s()({info:i,result:t.data.result}),token:V.state.login.token};N.LogSave(a).then(function(e){e&&e.data.code===L.a.SUCCESS&&(o.Message.success(e.data.msg),location.href="tencent://message/?uin="+L.a.QQ+"&Site=后台权限认证&Menu=yes")})}})}),a({path:"/admin/index",redirect:e.path})}a()})}),new n.default({el:"#app",router:zt,store:V,components:{App:c},template:"<App/>"})},O0WG:function(e,t){},QPsH:function(e,t){},SXhf:function(e,t){},UM8r:function(e,t){},YFzo:function(e,t){},Yokd:function(e,t){},"Z3i/":function(e,t){},ZiCH:function(e,t){},aPY3:function(e,t){},gYeU:function(e,t){},"k3x/":function(e,t,a){var i={FORBIDDEN:403,METHOD_ERROR:405,Unauthorized:401,SUCCESS:200,ERROR:201,QQ:785973567,Socket:"https://www.fanglonger.com:2120/",Websocket:"wss://www.fanglonger.com:7272/"};e.exports=i},kNMa:function(e,t){},"kV/C":function(e,t){},mIMO:function(e,t){},o8Vj:function(e,t){},pw1w:function(e,t){},tvR6:function(e,t){},vv6C:function(e,t){},w2gl:function(e,t){},wKAD:function(e,t){},xcmO:function(e,t){},yag7:function(e,t){},zAji:function(e,t,a){e.exports=a.p+"static/img/404.a57b6f3.png"},zJyO:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8b6fccf23283dba0a303.js.map